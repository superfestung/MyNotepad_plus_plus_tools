<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Datei schreiben (WRITE)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Datei schreiben (WRITE)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <p>Mit dem WRITE-Befehl können Sätze/Daten aus dem NC-Programm an das Ende einer sich im passiven Filesystem oder auf einem externen Programmspeicher befindlichen Datei (Protokolldatei) geschrieben werden. Dies kann auch das gerade in Abarbeitung befindliche Programm sein. Falls die zu beschreibende Datei in dem als Zielverzeichnis angegebenen Programmspeicher nicht vorhanden ist, wird sie neu angelegt.</p>
      <a name="block_1">
      </a>
      <h3 class="Blocktitle">Voraussetzungen</h3>
      <h4 class="Blocklabel">Schutzstufe</h4>
      <p>Die aktuell eingestellte Schutzstufe muss gleich oder größer dem WRITE-Recht der Datei sein. Ist dies nicht der Fall, wird der Zugriff mit Fehlermeldung (Rückgabewert der Fehlervariablen = 13) abgelehnt.</p>
      <h4 class="Blocklabel">Zugriff auf EES-Laufwerke</h4>
      <p>Externe Programmspeicher auf Laufwerken, für die bei der Inbetriebnahme eine Verwendung durch die Funktion "Abarbeiten von externem Speicher (EES)" eingerichtet wurde, können von Dateihandlings-Befehlen nur dann angesprochen werden, wenn die lizenzpflichtige Option zur Nutzung dieser Funktion gesetzt ist.</p>
      <a name="block_2">
      </a>
      <h3 class="Blocktitle">Syntax</h3>
      <a id="table_5cc42080-26d5-4378-8d6e-dbbe0701c61f">
      </a> <a id="table_0"></a> <a id="table_5cc42080-26d5-4378-8d6e-dbbe0701c61f"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="E4B"><colgroup><col width="100.0%"></colgroup><tr valign="top"><td>DEF INT &lt;Error></td></tr><tr valign="top"><td>...</td></tr><tr valign="top"><td>WRITE(&lt;Error>,"&lt;FileName>"/"&lt;ExtG>","&lt;Set/Data>")</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><a name="block_3"></a><h3 class="Blocktitle">Bedeutung</h3><a id="table_9348d040-85bb-40b8-bf8c-c66eaa3e891d"></a> <a id="table_1"></a> <a id="table_9348d040-85bb-40b8-bf8c-c66eaa3e891d"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="19.7%"><col width="9.0%"><col width="6.8%"><col width="64.4%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>WRITE</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Befehl zum Anfügen eines Satzes bzw. von Daten an das Ende der angegebenen Datei</p></td></tr><tr valign="top"><td rowspan="14"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Error></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 1:</b> Variable für die Rückgabe des Fehlerwerts</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Typ:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td rowspan="12"><p type="p_table_l" style="margin-top: 4px" align="left">Wert:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">0</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">kein Fehler</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">1</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Pfad nicht erlaubt</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">2</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Pfad nicht gefunden</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">3</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Datei nicht gefunden</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">4</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">falscher Dateityp</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">10</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Datei ist voll</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">11</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Datei wird benutzt</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">12</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">keine Ressourcen frei</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">13</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">keine Zugriffsrechte</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">14</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">fehlendes oder fehlgeschlagenes EXTOPEN für das Ausgabegerät</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">15</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Fehler beim Schreiben auf externes Gerät</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">16</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">ungültiger externer Pfad programmiert</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;FileName></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 2: </b>Name der Datei, in der der angegebene Satz bzw. die angegebenen Daten angefügt werden sollen</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Typ:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Vor dem eigentlichen Dateinamen kann der absolute Pfad angegeben werden. Ohne Pfadangabe wird die Datei im aktuellen Verzeichnis (= Verzeichnis des angewählten Programms) gesucht.</p><p type="p_table_l" align="left">Regeln zur Pfadangabe siehe "<a href="156662796555.html">Adressierung von Dateien des Programmspeichers</a>".</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;ExtG></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Sollen Daten über die Funktion "Process DataShare" auf ein externes Gerät/Datei ausgegeben werden, muss statt des Dateinamens der symbolische Bezeichner für das zu öffnende externe Gerät/Datei angegeben werden.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Typ:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Weitere Informationen siehe "<a href="156664199563.html">Process DataShare - Ausgabe auf ein externes Gerät/Datei (EXTOPEN, WRITE, EXTCLOSE)</a>".</p><p type="p_table_l" align="left"><b>Hinweis:<br /></b>Der Bezeichner muss identisch zu dem im EXTOPEN-Befehl angegebenen Bezeichner sein. </p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Set/Data></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 3:</b> Satz bzw. Daten, die in der angegebenen Datei angefügt werden sollen.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Typ:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr></table></p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Hinweis</b></td></tr><tr><td><p class="safety">Beim Schreiben ins passive Dateisystem oder auf einen externen Programmspeicher fügt der WRITE-Befehl implizit ein "LF"-Zeichen (LINE FEED = neue Zeile) an das Ende des Ausgabestrings an.</p><p class="safety">Für die Ausgabe auf ein externes Gerät/Datei über die Funktion "Process DataShare" gilt dieses Verhalten nicht. Soll ein "LF" mit ausgegeben werden, muss das explizit im Ausgabestring mit angegeben werden.</p><p class="safety">→ Siehe hierzu Beispiel 3: Implizites/explizites "LF"!</p></td></tr></table><a name="block_4"></a><h3 class="Blocktitle">Randbedingungen</h3><p><b>Maximale Dateigröße (→ Maschinenhersteller!)</b></p><p>Die maximal mögliche Dateigröße von Protokolldateien im passiven Filesystem wird eingestellt mit dem Maschinendatum:</p><p>MD11420 $MN_LEN_PROTOCOL_FILE</p><p>Die maximale Dateigröße gilt für alle Dateien, die mit dem WRITE-Befehl im passiven Filesystem angelegt werden. Bei Überschreitung wird eine Fehlermeldung ausgegeben und der Satz bzw. die Daten werden nicht abgespeichert. Sofern der Speicher ausreicht, kann eine neue Datei angelegt werden.</p><a name="block_5"></a><h3 class="Blocktitle">Beispiele</h3><h4 class="Blocklabel">Beispiel 1: WRITE-Befehl ins passive Filesystem ohne absolute Pfadangabe</h4><a id="table_c480131d-1021-4528-88e7-c6a9260badbf"></a> <a id="table_2"></a> <a id="table_c480131d-1021-4528-88e7-c6a9260badbf"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="E4BAC"><colgroup><col width="57.5%"><col width="42.5%"></colgroup><tr valign="top"><th>Programmcode</th><th>Kommentar</th></tr><tr valign="top"><td>N10 DEF INT ERROR</td><td>; Definition der Fehlervariablen.</td></tr><tr valign="top"><td>N20 WRITE(ERROR,"PROT","PROTOKOLL VOM 7.2.97")</td><td>; Schreibe den Text "PROTOKOLL VOM 7.2.97" in die Datei _N_PROT_MPF.</td></tr><tr valign="top"><td>N30 IF ERROR</td><td>; Fehlerauswertung.</td></tr><tr valign="top"><td>N40 MSG ("Fehler bei WRITE-Befehl:" &lt;&lt; ERROR)</td><td> </td></tr><tr valign="top"><td>N50 M0</td><td> </td></tr><tr valign="top"><td>N60 ENDIF</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><h4 class="Blocklabel">Beispiel 2: WRITE-Befehl ins passive Filesystem mit absoluter Pfadangabe</h4><a id="table_fc0e2497-6b41-4ff4-ac0a-edda72c2aab5"></a> <a id="table_3"></a> <a id="table_fc0e2497-6b41-4ff4-ac0a-edda72c2aab5"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EQDAC"><colgroup><col width="84.5%"><col width="15.5%"></colgroup><tr valign="top"><th>Programmcode</th><th> </th></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>WRITE(ERROR,"/_N_WKS_DIR/_N_PROT_WPD/_N_PROT_MPF","PROTOKOLL VOM 7.2.97")</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><h4 class="Blocklabel">Beispiel 3: Implizites/explizites "LF"</h4><p>a, Schreiben ins passive Dateisystem mit implizit erzeugtem "LF"</p><a id="table_70c8c005-1ef9-4164-9a17-216dd4bdb8c4"></a> <a id="table_4"></a> <a id="table_70c8c005-1ef9-4164-9a17-216dd4bdb8c4"></a> <a id="table_4"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EMEAC"><colgroup><col width="85.0%"><col width="15.0%"></colgroup><tr valign="top"><th>Programmcode</th><th> </th></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N110 DEF INT ERROR</td><td> </td></tr><tr valign="top"><td>N120 WRITE(ERROR,"/_N_MPF_DIR/_N_MYPROTFILE_MPF","MY_STRING")</td><td> </td></tr><tr valign="top"><td>N130 WRITE(ERROR,"/_N_MPF_DIR/_N_MYPROTFILE_MPF","MY_STRING")</td><td> </td></tr><tr valign="top"><td>N140 M30</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p>Ausgabeergebnis:</p><p>MY_STRING</p><p>MY_STRING</p><p></p><p>b, Schreiben in externe Datei ohne implizit erzeugtem "LF"</p><a id="table_37866cc2-bb80-4f5b-abcc-b559226ea017"></a> <a id="table_5"></a> <a id="table_37866cc2-bb80-4f5b-abcc-b559226ea017"></a> <a id="table_5"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="ESFAC"><colgroup><col width="85.2%"><col width="14.8%"></colgroup><tr valign="top"><th>Programmcode</th><th> </th></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N200 DEF STRING[30] DEV_1</td><td> </td></tr><tr valign="top"><td>N210 DEF INT ERROR</td><td> </td></tr><tr valign="top"><td>N220 DEV_1="LOCAL_DRIVE/myprotfile.mpf"</td><td> </td></tr><tr valign="top"><td>N230 EXTOPEN(ERROR,DEV_1)</td><td> </td></tr><tr valign="top"><td>N240 WRITE(ERROR,DEV_1,"MY_STRING")</td><td> </td></tr><tr valign="top"><td>N250 WRITE(ERROR,DEV_1,"MY_STRING")</td><td> </td></tr><tr valign="top"><td>N260 EXTCLOSE(ERROR,DEV_1)</td><td> </td></tr><tr valign="top"><td>N270 M30</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p>Ausgabeergebnis:</p><p>MY_STRINGMY_STRING</p><p></p><p>c, Schreiben in externe Datei mit explizit programmiertem "LF"</p><p>Um dasselbe Ergebnis wie bei a, zu erzielen, muss Folgendes programmiert werden:</p><a id="table_b118522f-7b64-46bd-aa0a-450cb76485e7"></a> <a id="table_6"></a> <a id="table_b118522f-7b64-46bd-aa0a-450cb76485e7"></a> <a id="table_6"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EIHAC"><colgroup><col width="85.5%"><col width="14.5%"></colgroup><tr valign="top"><th>Programmcode</th><th> </th></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N200 DEF STRING[30] DEV_1</td><td> </td></tr><tr valign="top"><td>N210 DEF INT ERROR</td><td> </td></tr><tr valign="top"><td>N220 DEV_1="LOCAL_DRIVE/myprotfile.mpf"</td><td> </td></tr><tr valign="top"><td>N230 EXTOPEN(ERROR,DEV_1)</td><td> </td></tr><tr valign="top"><td>N240 WRITE(ERROR,DEV_1,"MY_STRING<b>'H0A'</b>")</td><td> </td></tr><tr valign="top"><td>N250 WRITE(ERROR,DEV_1,"MY_STRING<b>'H0A'</b>")</td><td> </td></tr><tr valign="top"><td>N260 EXTCLOSE(ERROR,DEV_1)</td><td> </td></tr><tr valign="top"><td>N270 M30</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p>Ausgabeergebnis:</p><p>MY_STRING</p><p>MY_STRING</p></div>
  </body>
</html>