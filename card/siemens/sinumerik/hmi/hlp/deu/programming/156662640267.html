<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Parameterübergabe</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Parameterübergabe</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <a name="block_1">
      </a>
      <h3 class="BlocktitleFirst">Definition eines Unterprogramms mit Parameterübergabe</h3>
      <p>Die Definition eines Unterprogramms mit Parameterübergabe erfolgt mit dem Schlüsselwort <code>PROC</code> und einer vollständigen Auflistung aller vom Unterprogramm erwarteten Parameter.  </p>
      <a name="block_2">
      </a>
      <h3 class="Blocktitle">Aufruf eines Unterprogramms mit Parameterübergabe</h3>
      <p>Beim Aufruf des Unterprogramms müssen nicht immer alle in der Unterprogrammschnittstelle definierten Parameter explizit übergeben werden. Wird ein Parameter weggelassen, wird für diesen Parameter der Standardwert "0" übergeben.</p>
      <p>Zur eindeutigen Kennzeichnung der Reihenfolge der Parameter müssen allerdings die Kommas als Trennzeichen der Parameter immer mit angegeben werden. Eine Ausnahme bildet der letzte Parameter. Wird dieser beim Aufruf weggelassen, kann auch das letzte Komma entfallen.</p>
      <p>
        <b>Beispiel:</b>
      </p>
      <p>Unterprogramm:</p>
      <a id="table_0">
      </a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EDC"><colgroup><col width="53.8%"><col width="46.2%"></colgroup><tr valign="top"><th>Programmcode</th><th>Kommentar</th></tr><tr valign="top"><td>PROC SUB_PROG (REAL X, REAL Y, REAL Z)</td><td>; Formalparameter: X, Y und Z</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N100 RET</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><p>Hauptprogramm:</p><a id="table_1"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EBD"><colgroup><col width="39.1%"><col width="60.9%"></colgroup><tr valign="top"><th>Programmcode</th><th>Kommentar</th></tr><tr valign="top"><td>PROC MAIN_PROG</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N30 SUB_PROG(1.0,2.0,3.0)</td><td>; Unterprogrammaufruf mit vollständiger Parameterübergabe:X=1.0, Y=2.0, Z=3.0</td></tr><tr valign="top"><td>…</td><td> </td></tr><tr valign="top"><td>N100 M30</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p>Beispiele für den Unterprogrammaufruf in N30 mit unvollständiger Parameterübergabe:</p><a id="table_2"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_invisible" border="0"><colgroup><col width="41.5%"><col width="2.3%"><col width="56.1%"></colgroup><tr valign="top"><td>N30 SUB_PROG( ,2.0,3.0)</td><td>;</td><td>X=0.0, Y=2.0, Z=3.0</td></tr><tr valign="top"><td>N30 SUB_PROG(1.0, ,3.0)</td><td>;</td><td>X=1.0, Y=0.0, Z=3.0</td></tr><tr valign="top"><td>N30 SUB_PROG(1.0,2.0)</td><td>;</td><td>X=1.0, Y=2.0, Z=0.0</td></tr><tr valign="top"><td>N30 SUB_PROG( , ,3.0)</td><td>;</td><td>X=0.0, Y=0.0, Z=3.0</td></tr><tr valign="top"><td>N30 SUB_PROG( , , )</td><td>;</td><td>X=0.0, Y=0.0, Z=0.0</td></tr></table></p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee" style="margin-bottom:10px"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Hinweis</b></td></tr><tr><td><h4 class="Blocklabel">Parameterübergabe Call-by-Reference</h4><p class="safety">Parameter, die über Call-by-Reference übergeben werden, dürfen beim Unterprogramm-Aufruf nicht weggelassen werden.</p></td></tr></table><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Hinweis</b></td></tr><tr><td><h4 class="Blocklabel">Datentyp AXIS</h4><p class="safety">Parameter vom Datentyp AXIS dürfen beim Unterprogramm-Aufruf nicht weggelassen werden.</p></td></tr></table><a name="block_3"></a><h3 class="Blocktitle">Überprüfung der Übergabeparameter  </h3><p>Über die Systemvariable $P_SUBPAR [ n ] mit n = 1, 2, ... kann im Unterprogramm überprüft werden, ob ein Parameter explizit übergeben oder weggelassen wurde. Der Index n bezieht sich auf die Reihenfolge der Formalparameter. Index n = 1 bezieht sich auf den 1. Formalparameter, Index n = 2 auf den 2. Formalparameter usw.</p><p>Der folgende Programmausschnitt zeigt beispielhaft für den 1. Formalparameter, wie eine Überprüfung realisiert werden kann:</p><a id="table_3"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EDG"><colgroup><col width="53.0%"><col width="47.0%"></colgroup><tr valign="top"><th>Programmierung</th><th>Kommentar</th></tr><tr valign="top"><td>PROC SUB_PROG (REAL X, REAL Y, REAL Z)</td><td>; Formalparameter: X, Y und Z</td></tr><tr valign="top"><td>N20 IF $P_SUBPAR[1]==TRUE</td><td>; Überprüfung des 1.Formalparameters X.</td></tr><tr valign="top"><td>...</td><td>; Diese Aktionen werden ausgeführt, wenn der Formalparameter X explizit übergeben wurde.</td></tr><tr valign="top"><td>N40 ELSE</td><td> </td></tr><tr valign="top"><td>...</td><td>; Diese Aktionen werden ausgeführt, wenn der Formalparameter X nicht übergeben wurde.</td></tr><tr valign="top"><td>N60 ENDIF</td><td> </td></tr><tr valign="top"><td>...</td><td>; Allgemeine Aktionen</td></tr><tr valign="top"><td>N100 RET</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p></div>
    <p>Siehe auch:<br />    <a href="156662636043.html">Formal- und Aktualparameter</a><br />    <a href="156662619915.html">Unterprogramm</a></p>
  </body>
</html>