<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Fenster aus dem Teileprogramm interaktiv aufrufen (MMC)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Fenster aus dem Teileprogramm interaktiv aufrufen (MMC)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <p>Über das vordefinierte Unterprogramm MMC(...) können aus einem NC-Programm heraus anwenderspezifische Dialoge auf der Bedienoberfläche angezeigt werden. </p>
      <p>Die Projektierung der Dialoge kann für folgende Dialogarten erfolgen:</p>
      <ul>
        <li>
          <p>Run MyScreens </p>
        </li>
        <li>
          <p>Anwender-XML</p>
        </li>
      </ul>
      <h4 class="Blocklabel">Weitere Informationen:</h4>
      <ul>
        <li>
          <p>Programmierhandbuch Run MyScreens</p>
        </li>
      </ul>
      <a name="block_1">
      </a>
      <h3 class="Blocktitle">Syntax</h3>MMC("&lt;ADDRESS>,&lt;COMMAND>,&lt;FILE>,&lt;DIALOG>","&lt;QUIT>")<a name="block_2"></a><h3 class="Blocktitle">Bedeutung</h3><a id="table_5a1d0deb-502a-f945-fc68-2ae65fa4830e"></a> <a id="table_0"></a> <a id="table_5a1d0deb-502a-f945-fc68-2ae65fa4830e"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="25.0%"><col width="10.7%"><col width="32.0%"><col width="32.3%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>MMC(...)</code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Unterprogrammbezeichner</p><p type="p_table_l" align="left">Die Parameter werden platzcodiert und durch Komma getrennt innerhalb von zwei Strings, dem Kommando-String und dem Quittungs-String, angegeben.</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left">Parameter innerhalb des Kommando-Strings:</p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;ADDRESS></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Bedienbereich, in dem die projektierten Anwenderdialoge ausgeführt werden</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Funktion</b></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><b>Bedienbereiche</b></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Anwenderdialog "Run MyScreens"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>CYCLES</code></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Anwender-XML</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>XML</code></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Popup "Run MyScreens"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>POPUPDLG</code></p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;COMMAND></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Auszuführendes Kommando</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Funktion</b></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><b>Kommandos</b></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Anwenderdialog "Run MyScreens"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>PICTURE_ON</code>, <code>PICTURE_OFF</code></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Anwender-XML</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>XML_ON</code>, <code>XML_OFF</code></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Popup "Run MyScreens"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>PICTURE_ON</code>, <code>PICTURE_OFF</code></p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;FILE></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Name der Datei, in der der anzuzeigende Dialog programmiert ist</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Funktion</b></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><b>Dateien</b></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Anwenderdialog "Run MyScreens"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;name>.com</code></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Anwender-XML</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;name>.xml</code></p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Popup "Run MyScreens"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;name>.com</code></p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;DIALOG></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">In der Datei <code>&lt;FILE></code> projektierter Name des Dialogs</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left">Parameter innerhalb des Quittungs-Strings:</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;QUIT></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Quittungstyp</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>N</code>:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Keine Quittierung.</p><p type="p_table_l" align="left">Die Programmbearbeitung wird nach Absenden des Kommandos fortgeführt. Es erfolgt keine Rückmeldung, wenn das Kommando nicht erfolgreich ausgeführt werden konnte.</p><p type="p_table_l" align="left"><b>Hinweis</b></p><p type="p_table_l" align="left">Quittungstyp "N" ist zu verwenden, wenn im NC-Programm eine Anzeigezeit (Verweilzeit) programmiert wird (siehe unten Beispiel 2)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>A</code>:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Asynchrone Quittierung</p><p type="p_table_l" align="left">Die Programmabarbeitung wird nach Absetzen des Befehls fortgeführt. Der Rückgabewert wird in einer im Rahmen der Dialogprojektierung definierten anwenderspezifischen Quittungsvariablen (GUD-Variable) abgelegt und kann im NC-Programm gelesen werden.</p></td></tr></table></p><a name="block_3"></a><h3 class="Blocktitle">Randbedingungen</h3><ul><li><p>Die Definitionsdateien *.com der Dialoge müssen im Ordner "proj" abgelegt werden.</p></li><li><p>Anwenderdefinierte Dialoge können nicht gleichzeitig aus unterschiedlichen Kanälen heraus angezeigt werden.</p></li><li><p>In der Simulation wird die MMC-Funktionalität nicht unterstützt.  </p></li></ul><a name="block_4"></a><h3 class="Blocktitle">Beispiele</h3><h4 class="Blocklabel">Beispiel 1</h4><p>Anzeige eines Dialogs und Reaktion auf die Anwenderbedienung in einem NC-Programm.</p><a id="table_fa12a8a9-6adf-8127-0d68-b7154d5d522d"></a> <a id="table_1"></a> <a id="table_fa12a8a9-6adf-8127-0d68-b7154d5d522d"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="ELBAC"><colgroup><col width="50.0%"><col width="50.0%"></colgroup><tr valign="top"><th>Programmcode</th><th>Kommentar</th></tr><tr valign="top"><td colspan="2">; Die Quittungsvariable QUIT wurde bereits als globale Anwendervariable (GUD); vom Typ STRING bei der Projektierung des Dialoges angelegt:; DEF NCK STRING[20] QUIT</td></tr><tr valign="top"><td>QUIT = "XXX"</td><td>; Quittungsvariable initialisieren</td></tr><tr valign="top"><td>G4 F5</td><td> </td></tr><tr valign="top"><td>MMC("CYCLES,PICTURE_ON,test.com,test1","A")</td><td>; Dialog anzeigen;  - Bedienbereich: CYCLES;  - Bildstatus: PICTURE_ON (anzeigen);  - Dialogbild-Datei: test.com;  - Dialogbild: test1</td></tr><tr valign="top"><td>INPUT:</td><td>; Warten auf Anwenderbedienung</td></tr><tr valign="top"><td>   STOPRE</td><td>;    Vorlaufstop</td></tr><tr valign="top"><td>   IF MATCH (QUIT,"RUN") >= 0 GOTOF WORK</td><td>;    Softkey "RUN"</td></tr><tr valign="top"><td>   IF MATCH (QUIT,"CHK") >= 0 GOTOF CHECK</td><td>;    Softkey "CHK"</td></tr><tr valign="top"><td>GOTOB INPUT</td><td>; => Warten</td></tr><tr valign="top"><td> </td><td> </td></tr><tr valign="top"><td>WORK:</td><td>; Softkey "RUN" gedrückt</td></tr><tr valign="top"><td>MSG("Weiter mit Bearbeitung -> NC-Start")</td><td>; Meldung ausgeben</td></tr><tr valign="top"><td>MMC("CYCLES,PICTURE_OFF","N")</td><td>; Dialog schließen</td></tr><tr valign="top"><td>M0</td><td>; Warten auf NC-Start</td></tr><tr valign="top"><td>GOTOF END</td><td>; => Programmende</td></tr><tr valign="top"><td> </td><td> </td></tr><tr valign="top"><td>CHECK:</td><td>; Softkey "CHK" gedrückt</td></tr><tr valign="top"><td>MSG("Position anfahren -> NC-Start")</td><td>; Meldung ausgeben</td></tr><tr valign="top"><td>MMC("CYCLES,PICTURE_OFF","N")</td><td>; Dialog schließen</td></tr><tr valign="top"><td>M0</td><td>; Warten auf NC-Start</td></tr><tr valign="top"><td>GOTOF END</td><td>; => Programmende</td></tr><tr valign="top"><td> </td><td> </td></tr><tr valign="top"><td>END:</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">Beispiel 2</h4><p>Die Anzeigezeit eines Dialogs wird im NC-Programm z. B. über eine Verweilzeit festgelegt.</p><a id="table_18a074f2-9ba8-6283-3d3c-b9059e523082"></a> <a id="table_2"></a> <a id="table_18a074f2-9ba8-6283-3d3c-b9059e523082"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EPFAC"><colgroup><col width="62.4%"><col width="37.6%"></colgroup><tr valign="top"><th>Programmcode</th><th>Kommentar</th></tr><tr valign="top"><td>F1000 G94</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>MMC("POPUPDLG,PICTURE_<b>ON</b>,xmldial_emb.xml,main","N")</td><td>; Dialog anzeigen</td></tr><tr valign="top"><td>X200</td><td> </td></tr><tr valign="top"><td>Z40</td><td> </td></tr><tr valign="top"><td>MMC("POPUPDLG,PICTURE_<b>OFF</b>","N")</td><td>; Dialog schließen</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">Beispiel 3</h4><p>Einbetten eines PopUp-Scripts in ein NC-Programm und dessen Verwendung.</p><a id="table_185f61a5-b775-e609-6b42-ca1708832d8f"></a> <a id="table_3"></a> <a id="table_185f61a5-b775-e609-6b42-ca1708832d8f"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="E6GAC"><colgroup><col width="100.0%"></colgroup><tr valign="top"><th><p type="p_table_lb" align="left">Programmcode</p></th></tr><tr valign="top"><td>PROC POPUP_TEST</td></tr><tr valign="top"><td>; ----------------------------- Script -----------------------------</td></tr><tr valign="top"><td>; &lt;main_dialog entry="rpara_main"></td></tr><tr valign="top"><td>;    &lt;let name="xpos" /></td></tr><tr valign="top"><td>;    &lt;let name="ypos" /></td></tr><tr valign="top"><td>;    &lt;let name="field_name" type="string" /></td></tr><tr valign="top"><td>;    &lt;let name="num" /></td></tr><tr valign="top"><td>;    &lt;menu name="rpara_main"></td></tr><tr valign="top"><td>;       &lt;open_form name="rpara_form"/></td></tr><tr valign="top"><td>;       &lt;softkey_back></td></tr><tr valign="top"><td>;          &lt;close_form /></td></tr><tr valign="top"><td>;       &lt;/softkey_back></td></tr><tr valign="top"><td>;    &lt;/menu></td></tr><tr valign="top"><td>;    &lt;form name="rpara_form"></td></tr><tr valign="top"><td>;       &lt;init></td></tr><tr valign="top"><td>;          &lt;caption>mask from NC part program&lt;/caption></td></tr><tr valign="top"><td>;          &lt;let name="count" >0&lt;/let></td></tr><tr valign="top"><td>;          &lt;op> </td></tr><tr valign="top"><td>;             xpos = 120;</td></tr><tr valign="top"><td>;             ypos = 34; </td></tr><tr valign="top"><td>;             "nck/Channel/Parameter/R[10]" = 10;</td></tr><tr valign="top"><td>;          &lt;/op></td></tr><tr valign="top"><td>;          &lt;!-- load the number of controls --></td></tr><tr valign="top"><td>;          &lt;op></td></tr><tr valign="top"><td>;             num = "nck/Channel/Parameter/R[10]";</td></tr><tr valign="top"><td>;          &lt;/op></td></tr><tr valign="top"><td>;          &lt;while></td></tr><tr valign="top"><td>;             &lt;condition> count &lt; num&lt;/condition></td></tr><tr valign="top"><td>;             &lt;print name="field_name" text="edit%d">count&lt;/print></td></tr><tr valign="top"><td>;             &lt;op></td></tr><tr valign="top"><td>;                ypos = ypos + 24;</td></tr><tr valign="top"><td>;                count = count + 1;</td></tr><tr valign="top"><td>;             &lt;/op></td></tr><tr valign="top"><td>;          &lt;/while></td></tr><tr valign="top"><td>;       &lt;/init></td></tr><tr valign="top"><td>;       &lt;paint></td></tr><tr valign="top"><td>;          &lt;op> </td></tr><tr valign="top"><td>;             xpos =  8;</td></tr><tr valign="top"><td>;             ypos = 36;</td></tr><tr valign="top"><td>;             count = 0;</td></tr><tr valign="top"><td>;          &lt;/op></td></tr><tr valign="top"><td>;          &lt;while></td></tr><tr valign="top"><td>;             &lt;condition>count &lt; num&lt;/condition></td></tr><tr valign="top"><td>;             &lt;print name="field_name" text="R-Parameter%d">count&lt;/print></td></tr><tr valign="top"><td>;             &lt;text xpos = "$xpos" ypos = "$ypos" >$$$field_name&lt;/text></td></tr><tr valign="top"><td>;             &lt;op></td></tr><tr valign="top"><td>;                ypos = ypos + 24;</td></tr><tr valign="top"><td>;                count = count + 1;</td></tr><tr valign="top"><td>;             &lt;/op> </td></tr><tr valign="top"><td>;          &lt;/while></td></tr><tr valign="top"><td>;       &lt;/paint></td></tr><tr valign="top"><td>;    &lt;/form></td></tr><tr valign="top"><td>; &lt;/main_dialog></td></tr><tr valign="top"><td>; ========================= Programmteil ===========================</td></tr><tr valign="top"><td>...</td></tr><tr valign="top"><td>G94 F100</td></tr><tr valign="top"><td>MMC("POPUPDLG,PICTURE_ON,<b>xmldial_emb.xml</b>,<b>main</b>","N")</td></tr><tr valign="top"><td>G4 F4</td></tr><tr valign="top"><td>X200</td></tr><tr valign="top"><td>MMC("POPUPDLG,PICTURE_OFF","N")</td></tr><tr valign="top"><td>G4 F2</td></tr><tr valign="top"><td>X0</td></tr><tr valign="top"><td>...</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p></div>
  </body>
</html>