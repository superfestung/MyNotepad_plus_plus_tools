<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Cross-channel program coordination (INIT, START, WAITM, WAITMC, WAITE, SETM, CLEARM)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Cross-channel program coordination (INIT, START, WAITM, WAITMC, WAITE, SETM, CLEARM)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <p>In principle, a channel of the NC can execute the program started in it independently of other channels. However, if several programs in several channels are simultaneously involved in machining a workpiece, then program sequences must be coordinated using the following coordination commands in the different channels.</p>
      <h4 class="Blocklabel">Channel name instead of channel number</h4>
      <p>Instead of the channel numbers, the channel names entered in MD20000 $MC_CHAN_NAME[&lt;Channel index>] can be used as parameters of the predefined procedures for the program coordination. The use of the channel names in the NC programs first has to be enabled:</p>
      <p>MD10280 $MN_PROG_FUNCTION_MASK, bit 1 = TRUE</p>
      <p>
      </p>
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td>
            <font size="1px">
            </font>
          </td>
        </tr>
      </table>
      <table class="safety" border="1" bgcolor="#eeeeee">
        <colgroup>
          <col width="5%">
          <col width="95%">
        </colgroup>
        <tr>
          <td>
            <b>Note</b>
          </td>
        </tr>
        <tr>
          <td>
            <h4 class="Blocklabel">Minimum distance between commands</h4>
            <p class="safety">At least two traversing block distances must be maintained between the commands INIT, START, WAITE, WAITM, SETM, CLEARM and the command WAITMC. WAITMC is an executable block, but is moved into the previous block for optimization, and then deleted as a block. SETM for example is not an executable block, and is moved into the next block so that if there were a distance of one block between two commands, both commands would be in the middle block. As only one block is possible, optimization is not performed with a one block distance for WAITMC. </p>
            <p class="safety">This stops the program, and processing is briefly interrupted.</p>
          </td>
        </tr>
      </table>
      <a name="block_1">
      </a>
      <h3 class="Blocktitle">Syntax</h3>INIT(&lt;ChanNo>, &lt;Prog>,­ &lt;AckMode>)START(&lt;ChanNo>, &lt;ChanNo>, ...)WAITM(&lt;MarkNo>, &lt;ChanNo>, &lt;ChanNo>, ...)WAITE(&lt;ChanNo>, &lt;ChanNo>, ...)WAITMC(&lt;MarkNo>, &lt;ChanNo>, &lt;ChanNo>, ...)SETM(&lt;MarkNo>, &lt;MarkNo>, ...)CLEARM(&lt;MarkNo>, &lt;MarkNo>, ...)<a name="block_2"></a><h3 class="Blocktitle">Meaning</h3><a id="table_c7506ec0-8bc8-b54b-017d-92d79cb6fc97"></a> <a id="table_0"></a> <a id="table_c7506ec0-8bc8-b54b-017d-92d79cb6fc97"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="15.0%"><col width="7.9%"><col width="7.5%"><col width="69.6%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>INIT()</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure for selecting the NC program that is to be executed in the specified channel</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>START()</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure for starting the selected program in the respective channel</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>WAITM()</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure to wait for a wait marker to be reached in the specified channels</p><p type="p_table_l" align="left">The specified wait marker is set by WAITM in the same channel. The previous block is terminated with exact stop. The wait marker is deleted after synchronization.</p><p type="p_table_l" align="left">A maximum of 10 markers can be set simultaneously in each channel.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>WAITE()</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure to wait for the end of program in one or more other channels</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>WAITMC()</code> <sup> 1)</sup></p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure to wait for a wait marker to be reached in the specified channels</p><p type="p_table_l" align="left">In contrast to WAITM, the braking of the axes to exact stop is only initiated if the other channels have not yet reached the wait marker.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>SETM()</code><sup>  1)</sup></p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure to set one or more wait markers for the channel coordination</p><p type="p_table_l" align="left">The processing in own channel is not affected by this. </p><p type="p_table_l" align="left">SETM remains valid after a channel reset and NC start.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>CLEARM()</code> <sup> 1)</sup></p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined procedure to delete one or more wait markers for the channel coordination</p><p type="p_table_l" align="left">The processing in own channel is not affected by this. </p><p type="p_table_l" align="left">CLEARM() deletes all wait markers in the channel.</p><p type="p_table_l" align="left">CLEARM(0) only deletes wait marker "0".</p><p type="p_table_l" align="left">CLEARM remains valid after a channel reset and NC start.</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;ChanNo></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Channel number</p><p type="p_table_l" align="left">The number of the own channel does not have to be specified.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Prog></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Absolute or relative path specification (<b>optional</b>) + program name</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Information relating to path data, see the Programming Manual NC Programming, Chapter <a href="156662796555.html">"Addressing program memory files"</a>.</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;AckMode></code> </p><p type="p_table_l" align="left"></p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Acknowledgment mode (<b>optional</b>)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">CHAR</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Values:</p><p type="p_table_l" align="left"></p></td><td><p type="p_table_c" style="margin-top: 4px" align="center">"N"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Without acknowledgment</p><p type="p_table_l" align="left">The program execution is continued after the command has been sent. The sender is not informed if the command cannot be executed successfully.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">"S"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Synchronous acknowledgment</p><p type="p_table_l" align="left">The program execution is stopped until the receiving component has acknowledged the command. If the acknowledgment is positive, the next command is executed. If the acknowledgment is negative, an error message is output.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;MarkNo></code>  </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Number of the wait marker</p><p type="p_table_l" align="left"><b>Note</b></p><p type="p_table_l" align="left">In a multi-channel system, a maximum of 100 wait markers are available (wait markers 0 ... 99). </p><p type="p_table_l" align="left">Only wait marker 0 is available in a single-channel system.</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><sup>1)</sup> For user-specific communications and/or coordination of channels, wait marks can be set using SETM / CLEARM also without using the conditional wait command WAITMC. The wait markers retain their values, even after a channel reset and NC start.</p></td></tr></table></p><a name="block_3"></a><h3 class="Blocktitle">Examples</h3><h4 class="Blocklabel">START using channel names from MD20000</h4><ul><li><p>Parameter assignment</p><p><code>MD10280 $MN_PROG_FUNCTION_MASK, bit 1 = TRUE</code></p><p><code>$MC_CHAN_NAME[ 0 ] = "MACHINING"; Name of channel 1</code></p><p><code>$MC_CHAN_NAME[ 1 ] = "INFEED"; Name of channel 2</code></p></li><li><p>Programming</p><a id="table_223f2310-6d8a-4fcc-91f9-eb1d33088fd4"></a> <a id="table_1"></a> <a id="table_223f2310-6d8a-4fcc-91f9-eb1d33088fd4"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default_list" border="1"><colgroup><col width="30.9%"><col width="69.1%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>START(MACHINING)</td><td>; Start of channel 1</td></tr><tr valign="top"><td>START(INFEED)</td><td>; Start of channel 2</td></tr></table></p></li></ul><h4 class="Blocklabel">START using local "channel names" and user variables</h4><a id="table_905e07a2-66f9-4838-94e7-73c753797fff"></a> <a id="table_2"></a> <a id="table_905e07a2-66f9-4838-94e7-73c753797fff"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EBDAC"><colgroup><col width="31.1%"><col width="68.9%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>DEF INT MACHINE = 1</td><td>; Definition of user variable for channel 1</td></tr><tr valign="top"><td>DEF INT LOADER = 2</td><td>; Definition of user variable for channel 2</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>START(MACHINE)</td><td>; Start of channel 1</td></tr><tr valign="top"><td>START(LOADER)</td><td>; Start of channel 2</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">START using local "channel names", user variables and parameterized channel names</h4><a id="table_1e35ae8c-083a-4037-820a-7206810f72ad"></a> <a id="table_3"></a> <a id="table_1e35ae8c-083a-4037-820a-7206810f72ad"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EIEAC"><colgroup><col width="31.1%"><col width="68.9%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>DEF INT chanNo1</td><td>; Definition of user variable for channel 1</td></tr><tr valign="top"><td>DEF INT chanNo2</td><td>; Definition of user variable for channel 2</td></tr><tr valign="top"><td>chanNo1 = CHAN_1</td><td>; Assignment of parameterized channel name channel 1</td></tr><tr valign="top"><td>chanNo2 = CHAN_2</td><td>; Assignment of parameterized channel name channel 2</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>START(ChanNo1)</td><td>; Start of channel 1</td></tr><tr valign="top"><td>START(ChanNo2)</td><td>; Start of channel 2</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">INIT command with absolute path specification</h4><p class="comment">Selection of program /_N_MPF_DIR/_N_ABSPAN1_MPF in channel 2.</p><a id="table_d27be4c3-6a06-42a8-b573-ec4e2ceb5749"></a> <a id="table_4"></a> <a id="table_d27be4c3-6a06-42a8-b573-ec4e2ceb5749"></a> <a id="table_4"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="E1FAC"><colgroup><col width="100.0%"></colgroup><tr valign="top"><th><p type="p_table_lb" align="left" class="comment">Program code</p></th></tr><tr valign="top"><td>INIT(2,"/_N_WCS_DIR/_N_SHAFT1_WPD/_N_CUT1_MPF")</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">INIT command with program name</h4><p class="comment">Selection of the program with the name "MYPROG".  The control searches for the program using the search path.</p><a id="table_a84a9a77-08e8-4a06-8c94-3b53c4373323"></a> <a id="table_5"></a> <a id="table_a84a9a77-08e8-4a06-8c94-3b53c4373323"></a> <a id="table_5"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="EMGAC"><colgroup><col width="100.0%"></colgroup><tr valign="top"><th><p type="p_table_lb" align="left" class="comment">Program code</p></th></tr><tr valign="top"><td>INIT(2,"MYPROG")</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">Program coordination with WAITM</h4><ul class="comment"><li class="comment"><p class="comment">Channel 1: The program /_N_MPF_DIR/_N_MPF100_MPF has already been selected and started.</p><a id="table_83c1eebf-3566-4395-b4a3-e910055e437d"></a> <a id="table_6"></a> <a id="table_83c1eebf-3566-4395-b4a3-e910055e437d"></a> <a id="table_6"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default_list" border="1"><colgroup><col width="40.2%"><col width="59.8%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td> </td><td>; Program MPF100</td></tr><tr valign="top"><td>N10 INIT(2,"MPF200","N")</td><td>; Selection of program MPF200, channel 2</td></tr><tr valign="top"><td>N11 START(2)</td><td>; Start of channel 2</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N80 WAITM(1,1,2)</td><td>; Wait for WAIT marker 1 in channels 1 and 2</td></tr><tr valign="top"><td>N81 ...</td><td>; Channel 1, N81 and channel 2, N71 are; started synchronously</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N180 WAITM(2,1,2)</td><td>; Wait for WAIT marker 2 in channels 1 and 2</td></tr><tr valign="top"><td>N181 ...</td><td>; Channel 1, N181 and channel 2, N271 are; started synchronously</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N200 WAITE(2)</td><td>; Wait for end of program in channel 2</td></tr><tr valign="top"><td>N201 ...</td><td>; N201 is not started until the end of program; MPF200 started in channel 2</td></tr><tr valign="top"><td>N201 M30</td><td>; End of program channel 1</td></tr></table></p></li><li class="comment"><p class="comment">Channel 2: In channel 1, the program MPF200_MPF is selected and started for channel 2 using blocks N10 and N20.</p><a id="table_228ce7e1-5217-4c9a-9bc5-9b8887ab35dd"></a> <a id="table_7"></a> <a id="table_228ce7e1-5217-4c9a-9bc5-9b8887ab35dd"></a> <a id="table_7"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default_list" border="1"><colgroup><col width="40.2%"><col width="59.8%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>;$PATH=/_N_MPF_DIR</td><td>; Program MPF200</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N70 WAITM(1,1,2)</td><td>; Wait for WAIT marker 1 in channels 1 and 2</td></tr><tr valign="top"><td>N71 ...</td><td>; Channel 1, N81 and channel 2, N71 are; started synchronously</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N270 WAITM(2,1,2)</td><td>; Wait for WAIT marker 2 in channels 1 and 2</td></tr><tr valign="top"><td>N271 ...</td><td>; Channel 1, N181 and channel 2, N271 are; started synchronously</td></tr><tr valign="top"><td>...</td><td> </td></tr><tr valign="top"><td>N400 M30</td><td>; End of program channel 2</td></tr></table></p></li></ul><a id="image_791414667_0"></a> <img border="0" src="images/166652659339.png" width="500" height="226"/><a name="block_4"></a><h3 class="Blocktitle">Constraints</h3><h4 class="Blocklabel">Non-synchronous start of execution of following blocks after WAIT markers</h4><p>In the case of channel coordination using WAIT markers, execution of the following blocks may start non-synchronously. This behavior occurs if an action is triggered in one of the channels to be synchronized immediately before reaching the common WAIT marker; the consequence of which is implicit repositioning (REPOSA) in this delete distance-to-go.</p><p>Assumption: Current axis assignment in channels 1 and 2</p><ul><li><p>Channel 1: Axes X1 and U</p></li><li><p>Channel 2: Axis X2</p></li></ul><a id="table_994812b2-f1b5-2ac9-33d9-f3ab9b8ce3a3"></a> <a id="table_8"></a> <TableTitle>Time sequence in channels 1 and 2</TableTitle><a id="table_994812b2-f1b5-2ac9-33d9-f3ab9b8ce3a3"></a> <a id="table_8"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="25.0%"><col width="21.0%"><col width="54.0%"></colgroup><tr valign="top"><th><p type="p_table_cb" align="center">Channel 1</p></th><th><p type="p_table_cb" align="center">Channel 2</p></th><th><p type="p_table_lb" align="left">Description</p></th></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><code>...</code></p></td><td rowspan="2"><p type="p_table_c" style="margin-top: 4px" align="center"><code>...</code></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Arbitrary processing in channels 1 and 2</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>N100 WAITM(20,1,2)</code></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Channel 1: reaches the WAIT marker and waits for synchronization with channel 2</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><i>Start of the GETD(U) processing:</i></p><ul class="table"><li><p><i>Axis interchange</i></p></li><li><p><i>Delete distance-to-go</i></p></li><li><p><i>REPOSA</i></p></li></ul><p type="p_table_l" align="left"><i>End</i></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>N200 GETD(U)</code></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Channel 2: Requests axis U from channel 1</p><p type="p_table_l" align="left">Channel 1: Processing of GET(U) in the background</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>N210 WAITM(20,1,2)</code></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Channel 2: Reaches the WAIT marker. ⇒ This completes synchronization of channels 1 and 2</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>N220 G0 X2=100</code></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Channel 2: Start of processing of N220</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>N110 G0 X1=100</code></p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Channel 1: Staggered start of processing of N110</p></td></tr></table></p></div>
  </body>
</html>