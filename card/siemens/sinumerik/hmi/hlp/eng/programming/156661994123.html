<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Soft approach and retraction (G140 to G143, G147, G148, G247, G248, G347, G348, G340, G341, DISR, DISCL, DISRP, FAD, PM, PR): More information</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Soft approach and retraction (G140 to G143, G147, G148, G247, G248, G347, G348, G340, G341, DISR, DISCL, DISRP, FAD, PM, PR): More information</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <a name="block_1">
      </a>
      <h3 class="BlocktitleFirst">Further information</h3>
      <h4 class="Blocklabel">Selecting the approach and retraction contour</h4>
      <p>The approach and retraction contour are selected with the appropriate G command from the 2nd G group:</p>
      <a id="table_ea33eaa1-a38f-4c57-8841-d951bf4c7f69">
      </a> <a id="table_0"></a> <a id="table_ea33eaa1-a38f-4c57-8841-d951bf4c7f69"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="12.9%"><col width="87.0%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G147:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Approach with a straight line</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G247:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Approach with a quadrant</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G347:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Approach with a semicircle</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G148:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Retraction with a straight line</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G248:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Retraction with a quadrant</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G348:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Retraction with a semicircle</p></td></tr></table></p><p></p><a id="image_783818763_0"></a> <img border="0" src="images/167366737291.png" width="321" height="567" alt="Approach movements with simultaneous activation of the tool radius compensation"/><p class="imgtitle">Approach movements with simultaneous activation of the tool radius compensation</p><h4 class="Blocklabel">Selecting the approach and retraction direction</h4><p>Use the tool radius compensation (G140, default setting) to determine the approach and retraction direction with positive tool radius:</p><ul><li><p>G41 active → approach from left</p></li><li><p>G42 active → approach from right</p></li></ul><p>G141, G142 and G143 provide further approach options.</p><p>The G codes are only significant when the approach contour is a quadrant or a semicircle.</p><h4 class="Blocklabel">Motion steps between start point and end point (G340 and G341).</h4><p>In all cases, the movements are made up of one or more straight lines and, depending on the G command for determining the approach contour, an additional straight line or a quadrant or semicircle. The two variants of the path segmentation are shown in the following figure:</p><a id="image_783618187_0"></a> <img border="0" src="images/167364500491.png" width="302" height="265"/><a id="table_b48460c8-60a8-4f52-9a77-b5a70b1b603e"></a> <a id="table_1"></a> <a id="table_b48460c8-60a8-4f52-9a77-b5a70b1b603e"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="10.6%"><col width="89.3%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G340:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Approach with a straight line from point P<sub>0</sub> to point P<sub>1</sub>. This straight line is parallel to the machining plane, if parameter DISRP has not been programmed.</p><p type="p_table_l" align="left">Infeed perpendicular to the machining plane from point P<sub>1</sub> to point P<sub>3</sub> to the safety clearance to the machining plane defined by the DISCL parameter.</p><p type="p_table_l" align="left">Approach end point P4 with the curve determined by the G command of the second group (straight line, circle, helix). If G247 or G347 is active (quadrant or semicircle) and start point P<sub>3</sub> is outside the machining plane defined by the end point P<sub>4</sub>, a helix is inserted instead of a circle. Point P<sub>2</sub> is not defined or coincides with P<sub>3</sub>.</p><p type="p_table_l" align="left">The circle plane or the helix axis is determined by the plane, which is active in the SAR block (G17/G18/G19), i.e. the projection of the start tangent is used by the following block, instead of the tangent itself, to define the circle.</p><p type="p_table_l" align="left">The movement from point P<sub>0</sub> to point P<sub>3</sub> takes place along two straight lines at the velocity valid before the SAR block.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">G341:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Approach with a straight line from point P<sub>0</sub> to point P<sub>1</sub>. This straight line is parallel to the machining plane, if parameter DISRP has not been programmed.</p><p type="p_table_l" align="left">Infeed perpendicular to the machining plane from point P<sub>1</sub> up to the safety clearance to the machining plane defined by the DISCL parameter in point P<sub>2</sub>.</p><p type="p_table_l" align="left">Infeed perpendicular to the machining plane from point P<sub>2</sub> to point P<sub>3</sub>. Approach end point with the curve determined by the G command of the second group. P<sub>3</sub> and P<sub>4</sub> are located within the machining plane, with the result that a circle is always inserted instead of a helix with G247 or G347.</p></td></tr></table></p><p>In all cases that include the position of the active plane G17/G18/G19 (circular plane, helical axis, infeed motion perpendicular to the active plane), any active rotating frame is taken into account.</p><h4 class="Blocklabel">Length of the approach straight line or radius for approach circles (DISR)</h4><ul><li><p>Approach/retract with straight lines</p><p> DISR specifies the distance of the cutter edge from the starting point of the contour, i.e. the length of the straight line when TRC is active is the sum of the tool radius and the programmed value of DISR. The tool radius is only taken into account when it is positive.</p><p>The resulting straight line length must be positive, i.e. negative values for DISR are allowed provided that the absolute value of DISR is less than the tool radius.</p></li><li><p>Approach/retract with circles</p><p>DISR specifies the radius of the tool center point path. If TRC is activated, a circle is produced with a radius that results in the tool center point path with the programmed radius.</p></li></ul><h4 class="Blocklabel">Distance of point P2 from the machining plane (DISCL)</h4><p>If the position of point P<sub>2</sub> is to be specified by an absolute reference on the axis perpendicular to the circle plane, the value must be programmed in the form <code>DISCL=AC(...)</code>.</p><p>The following applies for DISCL=0:</p><ul><li><p>With G340: The whole of the approach motion now only consists of two blocks (P<sub>1</sub>, P<sub>2</sub> and P<sub>3</sub> are combined). The approach contour is formed by P<sub>1</sub> to P<sub>4</sub>.</p></li><li><p>With G341: The whole approach contour consists of three blocks (P<sub>2</sub> and P<sub>3</sub> are combined). If P<sub>0</sub> and P<sub>4</sub> are on the same plane, only two blocks result (infeed movement from P<sub>1</sub> to P<sub>3</sub> is omitted).</p></li><li><p>The point defined by DISCL is monitored to ensure that it is located between P<sub>1</sub> and P<sub>3</sub>, i.e. the sign must be identical for the component perpendicular to the machining plane in all motions that possess such a component.</p></li><li><p>On detection of a reversal of direction, a tolerance defined by the machine data MD20204 $MC_SAR_CLEARANCE_TOLERANCE is permitted.</p></li></ul><h4 class="Blocklabel">Distance of point P1 (retraction plane) from the machining plane (DISRP)</h4><p>If the position of point P<sub>1</sub> is to be specified by an absolute reference on the axis perpendicular to the machining plane, the value must be programmed in the form <code>DISRP=AC(...)</code>.</p><p>If this parameter is not programmed, point P<sub>1</sub> has the same distance to the machining plane as point P<sub>0</sub>, i.e. the approach straight line P<sub>0</sub> → P<sub>1</sub> is parallel to the machining plane.</p><p>The system checks that the point defined by DISRP lies between P<sub>0</sub> and P<sub>2</sub>, i.e. in all movements that have a component perpendicular to the machining plane (e.g. infeed movements, approach movements from P<sub>3</sub> to P<sub>4</sub>), this component must have the same leading sign. It is not permitted to change direction. An alarm is output if this condition is violated.</p><p>On detection of a reversal of direction, a tolerance defined by the machine data MD20204 $MC_SAR_CLEARANCE_TOLERANCE is permitted. However, if P<sub>1</sub> is outside the range defined by P<sub>0</sub> and P<sub>2</sub>, but the deviation is less than or equal to this tolerance, it is assumed that P<sub>1</sub> is in the plane defined by P<sub>0</sub> or P<sub>2</sub>.</p><h4 class="Blocklabel">Programming of the end point</h4><p>The end point is generally programmed with X... Y... Z...</p><p>The programming of the contour end point when approaching differs greatly from that for retraction. Both cases are therefore treated separately here.</p><p><b>Programming of end point P4 for approach</b></p><p>End point P<sub>4</sub> can be programmed in the actual SAR block. Alternatively, P<sub>4</sub> can be determined by the end point of the next traversing block. More blocks can be inserted between an SAR block and the next traversing block without moving the geometry axes.</p><p>Example:</p><a id="table_a08536d7-3605-4a18-ad7c-77adfbc605c7"></a> <a id="table_2"></a> <a id="table_a08536d7-3605-4a18-ad7c-77adfbc605c7"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EEDAC"><colgroup><col width="58.0%"><col width="42.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>$TC_DP1[1,1]=120</td><td>;Milling tool T1/D1</td></tr><tr valign="top"><td>$TC_DP6[1,1]=7</td><td>;Tool with 7 mm radius</td></tr><tr valign="top"><td>N10 G90 G0 X0 Y0 Z30 D1 T1</td><td> </td></tr><tr valign="top"><td>N20 X10</td><td> </td></tr><tr valign="top"><td>N30 G41 G147 DISCL=3 DISR=13 Z=0 F1000</td><td> </td></tr><tr valign="top"><td>N40 G1 X40 Y-10</td><td> </td></tr><tr valign="top"><td>N50 G1 X50</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><p><code>N30/N40</code> can be replaced by:</p>N30 G41 G147 DISCL=3 DISR=13 X40 Y-10 Z0 F1000<p>or</p>N30 G41 G147 DISCL=3 DISR=13 F1000N40 G1 X40 Y-10 Z0<a id="image_783648907_0"></a> <img border="0" src="images/167365739403.png" width="302" height="227"/><p></p><p><b>Programming of end point P0 for retraction</b></p><p>For retraction, the end point of the SAR contour cannot be programmed in a following block, i.e. the end position is always taken from the SAR block, irrespective of how many axes have been programmed. When determining the end point, a distinction is made between the following three cases:</p><ol><li><p>No geometry axis is programmed in the SAR block. In this case, the contour ends at point P<sub>1</sub> (if DISRP has been programmed), at point P<sub>2</sub> (if DISCL, but not DISRP has been programmed) or point P<sub>3</sub> (if neither DICLS nor DISRP has been programmed).</p><p>The position in the axes, which describe the machining plane, is determined by the retraction contour (end point of the straight line or arc). The axis component perpendicular to this is defined by DISCL or DISPR. If in this case both DISCL=0 and DISRP=0, the motion is completely in the plane, i.e.  points P<sub>0</sub> to P<sub>3</sub> coincide.</p></li><li><p>Only the axis perpendicular to the machining plane is programmed in the SAR block. In this case, the contour ends at point P<sub>0</sub>. If DISRP has been programmed (i.e. points P<sub>0</sub> and P<sub>1</sub> do not coincide), the straight line P<sub>1</sub> → P<sub>0</sub> is perpendicular to the machining plane. The positions of the two other axes are determined in the same way as in 1.</p></li><li><p>At least one axis of the machining plane is programmed. The second axis of the machining plane can be determined modally from its last position in the preceding block.</p></li></ol><p>The position of the axis perpendicular to the machining plane is generated as described in 1. or 2., depending on whether this axis is programmed or not. The position generated in this way defines the end point P<sub>0</sub>. If the SAR retraction block is also used to deactivate the tool radius compensation, in the first two cases, an additional path component is inserted in the machining plane from P<sub>1</sub> to P<sub>0</sub> so that no movement is produced when the tool radius compensation is deactivated at the end of the retraction contour, i.e. this point defines the tool center point and not a position on a contour to be corrected. In case 3, no special measures are required for deselection of the tool radius compensation, because the programmed point P<sub>0</sub> already directly defines the position of the tool center point at the end of the complete contour.</p><p>The behavior in cases 1 and 2, i.e. when an end point is not explicitly programmed in the machining plane with simultaneous deselection of the tool radius compensation, is shown in the following figure:</p><a id="image_783679627_0"></a> <img border="0" src="images/167365903115.png" width="302" height="227"/><h4 class="Blocklabel">Approach and retraction velocities</h4><ul><li><p>Velocity of the previous block (G0)</p><p>All motions from P<sub>0</sub> up to P<sub>2</sub> are executed at this velocity, i.e. the motion parallel to the machining plane and the part of the infeed motion up to the safety clearance.</p></li><li><p>Programming with FAD</p><p>Specification of the feedrate for</p><ul><li><p>G341: Infeed movement perpendicular to the machining plane from P<sub>2</sub> to P<sub>3</sub></p></li><li><p>G340: From point P<sub>2</sub> or P<sub>3</sub> to P<sub>4</sub>.</p><p>If FAD is not programmed, this part of the contour is traversed at the speed which is active modally from the preceding block, in the event that no F command defining the speed is programmed in the SAR block.</p></li></ul></li><li><p>Programmed feedrate F</p><p>This feedrate value is effective as of P<sub>3</sub> or P<sub>2</sub> if FAD is not programmed. If no F word is programmed in the SAR block, the speed of the previous block is active.</p></li></ul><p>Example:</p><a id="table_9b9a4c6b-ee7e-4dec-a518-3cbeb7f2c810"></a> <a id="table_3"></a> <TableTitle></TableTitle><a id="table_9b9a4c6b-ee7e-4dec-a518-3cbeb7f2c810"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EFIAC"><colgroup><col width="72.6%"><col width="27.4%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>$TC_DP1[1,1]=120</td><td>;Milling tool T1/D1</td></tr><tr valign="top"><td>$TC_DP6[1,1]=7</td><td>;Tool with 7 mm radius</td></tr><tr valign="top"><td>N10 G90 G0 X0 Y0 Z20 D1 T1</td><td> </td></tr><tr valign="top"><td>N20 G41 G341 G247 DISCL=AC(5) DISR=13 FAD 500 X40 Y-10 Z=0 F200</td><td> </td></tr><tr valign="top"><td>N30 X50</td><td> </td></tr><tr valign="top"><td>N40 X60</td><td> </td></tr><tr valign="top"><td>...</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><a id="image_783710347_0"></a> <img border="0" src="images/167366046219.png" width="302" height="231"/><p>During retraction, the roles of the modally active feedrate from the previous block and the programmed feedrate value in the SAR block are reversed, i.e. the actual retraction contour is traversed with the old feedrate and a new speed programmed with the F word applies from P<sub>2</sub> up to P<sub>0</sub>.</p><a id="image_783726603_0"></a> <img border="0" src="images/91447834123.png" width="306" height="265"/><a id="image_783757323_0"></a> <img border="0" src="images/91447975435.png" width="303" height="265"/><a id="image_783788043_0"></a> <img border="0" src="images/91448078347.png" width="303" height="265"/><h4 class="Blocklabel">Reading positions</h4><p>Points P<sub>3</sub> and P<sub>4</sub> can be read in the WCS as a system variable during approach.</p><ul><li><p>$P_APR: reading P </p></li><li><p><sub>3</sub> (initial point)</p></li><li><p>$P_AEP: reading P </p></li><li><p><sub>4</sub> (contour starting point)</p></li><li><p>$P_APDV: read whether $P_APR and $P_AEP contain valid data </p></li></ul></div>
  </body>
</html>