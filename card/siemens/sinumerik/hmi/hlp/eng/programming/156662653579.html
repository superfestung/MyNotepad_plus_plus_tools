<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Subprogram with call-by-reference parameter transfer (PROC, VAR)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Subprogram with call-by-reference parameter transfer (PROC, VAR)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <p>The calling program transfers not the value of a variable to the subprogram on a call-by-reference parameter transfer, but a reference (pointer) to the variable. This gives the subprogram direct access to the variable. In this way, not only the value visible in the subprogram is modified when a parameter value is changed, but also the value of the variables defined in the calling program. Call-by-reference parameter transfer therefore affects the calling program, even after the subprogram has ended.</p>
      <p>The following figure illustrates call-by-reference parameter transfer using an example:</p>
      <a id="image_791694091_0">
      </a> <img border="0" src="images/161883682955.png" width="454" height="340"/><a id="table_"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_legend" border="0"><colgroup><col width="5.0%"><col width="95.0%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">①</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Value assignment to the variables LENGTH and WIDTH in the calling program.  </p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">②</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">When the SUB1 subprogram is called, references to the two variables LENGTH and WIDTH are transferred to the subprogram. </p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">③</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">New value assignment to the variables LENGTH and WIDTH in the subprogram.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">④</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Because of the new value assignment in the subprogram, the values of the variables defined in the calling program change. The new values are therefore active even after the return from the subprogram.</p></td></tr></table></p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Note</b></td></tr><tr><td><p class="safety">The call-by-reference parameter transfer is then only necessary if the transferred variable was defined locally in the calling program (LUD). Channel-global or NC-global variables do not have to be transferred, since these cannot be accessed directly from within the subprogram.</p></td></tr></table><a name="block_1"></a><h3 class="Blocktitle">Syntax</h3><h4 class="Blocklabel">Definition</h4><p>A subprogram with call-by-reference parameter transfer is defined using the PROC keyword followed by the name of the program and a complete list of all the parameters with the VAR keyword, type, and name. The definition operation must appear in the first program line. As parameters, references to arrays can also be transferred:</p>PROC &lt;ProgName> (VAR &lt;Par1Type> &lt;Par1Name>, VAR &lt;Par2Type> &lt;Par2Name>, ...)PROC &lt;ProgName> (VAR &lt;Array1Type> &lt;Array1Name> [&lt;m>,&lt;n>,&lt;o>], VAR &lt;Array2Type> &lt;Array2Name> [&lt;m>,&lt;n>,&lt;o>], ...)<h4 class="Blocklabel">Call</h4><p>Subprograms with parameter transfer must be declared with the keyword EXTERN (external) before they are called in the main program.</p><p>→ See Chapter "<a href="156662698635.html">Subprogram call with parameter transfer (EXTERN)</a>".</p><p>The actual subprogram call is made via the program name and specification of the transfer parameters.</p><p>→ See Chapter "<a href="156662640267.html">Parameter transfer</a>".</p><a name="block_2"></a><h3 class="Blocktitle">Meaning</h3><a id="table_47840ff2-c3d2-45d4-9f0d-ef5493f18caf"></a> <a id="table_0"></a> <a id="table_47840ff2-c3d2-45d4-9f0d-ef5493f18caf"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="31.7%"><col width="10.6%"><col width="57.6%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>PROC</code>  </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Definition operation at the beginning of a program</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>VAR</code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Keyword for call-by-reference parameter transfer</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;ProgName></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Name of the program</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Par1Type></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type of the 1st parameter (e.g. REAL, INT, BOOL)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Par2Type></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type of the 2nd parameter</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Par1Name></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Name of the 1st parameter</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Par1Name></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Name of the 2nd parameter</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Array1Type></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type of the elements of array 1 (e.g. REAL, integer, BOOL)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Array2Type></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type of the elements of array 2</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Array1Name></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Name of array 1</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Array2Name></code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Name of array 2</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>[&lt;m>,&lt;n>,&lt;o>]</code> </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Array size</p><p type="p_table_l" align="left">Currently, up to 3-dimensional arrays are possible:</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;m></code> </p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Array size for 1st dimension</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;n></code> </p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Array size for 2nd dimension</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;o></code> </p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Array size for 3rd dimension</p></td></tr></table></p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Note</b></td></tr><tr><td><p class="safety">The program name specified after the PROC keyword must match the program name assigned on the user interface.</p></td></tr></table><a name="block_3"></a><h3 class="Blocktitle">Example</h3><p>Definition of a subprogram with two parameters as reference:</p><ul><li><p>Parameter 1: Reference to variable of type REAL with the name LENGTH</p></li><li><p>Parameter 2: Reference to variable of type REAL with the name WIDTH</p></li></ul><a id="table_4e9c6a4a-a56c-4e40-8df4-d75612f3391e"></a> <a id="table_1"></a> <a id="table_4e9c6a4a-a56c-4e40-8df4-d75612f3391e"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="EADAC"><colgroup><col width="100.0%"></colgroup><tr valign="top"><th><p type="p_table_lb" align="left">Program code</p></th></tr><tr valign="top"><td>PROC SUB_PROG(VAR REAL LENGTH, VAR REAL WIDTH)</td></tr><tr valign="top"><td>...</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p></div>
    <p>See also:<br />    <a href="161911611275.html">Subprogram with call-by-reference parameter transfer (PROC, VAR) More information</a></p>
  </body>
</html>