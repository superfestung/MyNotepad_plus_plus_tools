<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Process DataShare - Output to an external device/file (EXTOPEN, WRITE, EXTCLOSE)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Process DataShare - Output to an external device/file (EXTOPEN, WRITE, EXTCLOSE)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <p>The writing of data from a part program to an external device/file is performed in three steps: </p>
      <ol>
        <li>
          <p>Open the external device/file</p>
          <p>The external device/file is opened for the channel for writing using the EXTOPEN command. </p>
        </li>
        <li>
          <p>Writing data</p>
          <p>The output data can be processed using the string functions of the NC language, e.g. SPRINT. The WRITE command is used for writing.</p>
        </li>
        <li>
          <p>Close the external device/file</p>
          <p>The external device/file assigned in the channel is released again using the EXTCLOSE command, when the end of the program is reached (M30) or for a channel reset.</p>
        </li>
      </ol>
      <a name="block_1">
      </a>
      <h3 class="Blocktitle">Syntax</h3>
      <a id="table_b4a65940-3686-462b-a4d2-16b04ae39680">
      </a> <a id="table_0"></a> <a id="table_b4a65940-3686-462b-a4d2-16b04ae39680"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="EOB"><colgroup><col width="100.0%"></colgroup><tr valign="top"><td>DEF INT &lt;Result></td></tr><tr valign="top"><td>DEF STRING[&lt;n>] &lt;Output></td></tr><tr valign="top"><td>…</td></tr><tr valign="top"><td>EXTOPEN(&lt;Result>,&lt;ExtDev>,&lt;SyncMode>,&lt;AccessMode>,&lt;WriteMode>)</td></tr><tr valign="top"><td>…</td></tr><tr valign="top"><td>&lt;Output>="data output"</td></tr><tr valign="top"><td>WRITE(&lt;Result>,&lt;ExtDev>,&lt;Output>)</td></tr><tr valign="top"><td>…</td></tr><tr valign="top"><td>EXTCLOSE(&lt;Result>,&lt;ExtDev>)</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><a name="block_2"></a><h3 class="Blocktitle">Meaning</h3><a id="table_e8e99a99-81ed-4288-91d1-9be646910a68"></a> <a id="table_1"></a> <a id="table_e8e99a99-81ed-4288-91d1-9be646910a68"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="21.0%"><col width="10.0%"><col width="6.0%"><col width="8.0%"><col width="55.0%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>EXTOPEN</code>:</p></td><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left">Pre-defined procedure to open an external device/file</p></td></tr><tr valign="top"><td rowspan="16"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Result></code>:</p></td><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 1:</b> Result variable</p><p type="p_table_l" align="left">By using the result variable value, it can be evaluated in the program as to whether the operation was successful and processing is then appropriately continued.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td rowspan="14"><p type="p_table_l" style="margin-top: 4px" align="left">Values:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">0</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">No error</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">1</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">External device cannot be opened</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">2</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">External device is not configured</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">3</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">External device with invalid path configured</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">4</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">No access rights for external device</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">5</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Usage mode: External device already "exclusively" occupied</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">6</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Usage mode: External device already being "shared"</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">7</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">File length longer than LOCAL_DRIVE_MAX_FILESIZE</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">8</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Maximum number of external devices has been exceeded</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">9</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Option for LOCAL_DRIVE not set</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">11</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Reserved</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">12</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Write mode: Data contradicts extdev.ini</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">16</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Invalid external path has been programmed</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">22</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">External device not mounted</p></td></tr><tr valign="top"><td rowspan="9"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;ExtDev></code>:</p></td><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 2:</b> Symbolic identifier for the external device/file to be opened</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left">The symbolic identifier comprises:</p><ol class="table"><li><p>the logical device name</p></li><li><p>where relevant, followed by a file path (attached using "/").</p></li></ol><p type="p_table_l" align="left">The following <b>logical device names</b> have been defined:</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"LOCAL_DRIVE"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Local SD card (predefined)</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"CYC_DRIVE"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Reserved drive name for use in SIEMENS cycles (pre-defined)</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"/dev/ext/1"</code>, ...<br /><code>"/dev/ext/9"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Available network drives</p><p type="p_table_l" align="left"><b>Note:</b><br />It is necessary to configure in the extdev.ini file!</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"/dev/cyc/1"</code>,<code><br />"/dev/cyc/2"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Reserved drive names for use in SIEMENS cycles</p><p type="p_table_l" align="left"><b>Note:<br /></b>It is necessary to configure in the extdev.ini file!</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>File path:</b></p><ul class="table"><li><p>A file path must be specified for "LOCAL_DRIVE" and "CYC_DRIVE" e.g.</p><p>"LOCAL_DRIVE/my_dir/my_file.txt"</p></li><li><p>The logical device names "/dev/ext/1...9" and "/dev/cyc/1...2" can be configured:</p><ul><li><p>To already refer to a file, in which case only the logical device names may be specified, e.g.:</p><p>"/dev/ext/4"</p></li><li><p>Or to a directory, in which case a file path must be specified, e.g.:</p><p>"/dev/ext/5/my_dir/my_file.txt"</p></li></ul><p></p></li></ul></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Note:<br /></b>For the logical device names "/dev/ext/1...9", "/dev/v24" and "/dev/cyc/1...2" uppercase/lowercase is ignored; uppercase/lowercase is significant for specifying a path to a file. Only uppercase letters are permissible for "LOCAL_DRIVE" and "CYC_DRIVE".</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;SyncMode></code>:</p></td><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 3:</b> Processing mode for the WRITE commands to this device/file</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Values:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"SYN"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Synchronous writing</p><p type="p_table_l" align="left">Program execution is stopped until the write operation has been completed.</p><p type="p_table_l" align="left">Successfully completing the synchronous write operation can be checked by evaluating the error variables of the WRITE command. </p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"ASYN"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Asynchronous writing</p><p type="p_table_l" align="left">Program execution is not interrupted by the WRITE command.</p><p type="p_table_l" align="left"><b>Note.</b><br />In this mode, the result variable of the WRITE command does not provide any information and always has the value 0 (no error). In this particular mode, there is no certainty that the WRITE command was successful.</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;AccessMode></code>:</p></td><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 4:</b> Usage mode for this device/file</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Values:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"SHARED"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Device/file is requested in the "shared" mode. Other channels can also use the device, i.e. also open in this mode.</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"EXCL"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Device/file is exclusively used in the channel; no other channel can use the device.</p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;WriteMode></code>:</p><p type="p_table_l" align="left"></p></td><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Parameter 5:</b> Write mode for the WRITE commands to this file/device (optional)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Values:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"APP"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Attaching</p><p type="p_table_l" align="left">The file is always kept regarding its contents; write calls are attached at the end.</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><code>"OVR"</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Overwrite</p><p type="p_table_l" align="left">The contents of the file are deleted and re-generated using the subsequent write calls.</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Note:<br /></b>Using this parameter, the write mode configured in the extdev.ini file cannot be overwritten. In the case of a conflict, then the EXTOPEN call is acknowledged with error.</p></td></tr></table></p><a id="table_480b1478-4fed-90b4-4bcc-9b00e47e9ac2"></a> <a id="table_2"></a> <a id="table_480b1478-4fed-90b4-4bcc-9b00e47e9ac2"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="21.0%"><col width="79.0%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment"><code>WRITE</code>:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Pre-defined procedure to write output data</p></td></tr></table></p><a id="table_704e74fe-8071-c667-0332-e23831e8f6ba"></a> <a id="table_3"></a> <a id="table_704e74fe-8071-c667-0332-e23831e8f6ba"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="21.0%"><col width="10.0%"><col width="6.0%"><col width="63.0%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment"><code>EXTCLOSE</code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Pre-defined procedure to close an external device/file that has been opened</p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left" class="comment"><code>&lt;Result></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left" class="comment"><b>Parameter 1:</b> Result variable</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">INT</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Values:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">0</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">No error</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">16</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Invalid external path has been programmed</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">21</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Error when closing the external device</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment"><code>&lt;ExtDev></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left" class="comment"><b>Parameter 2: </b>Symbolic identifier for the external device/file description to be closed, see EXTOPEN!</p><p type="p_table_l" align="left" class="comment"><b>Note:<br /></b>The identifier must be identical to the identifier specified in the EXTOPEN call!</p></td></tr></table></p><a name="block_3"></a><h3 class="Blocktitle">Example</h3><a id="table_a6710145-a68c-4b50-bcec-cf09667aac94"></a> <a id="table_4"></a> <a id="table_a6710145-a68c-4b50-bcec-cf09667aac94"></a> <a id="table_4"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EXLAC"><colgroup><col width="12.1%"><col width="87.9%"></colgroup><tr valign="top"><th colspan="2">Program code</th></tr><tr valign="top"><td>N10</td><td>DEF INT RESULT</td></tr><tr valign="top"><td>N20</td><td>DEF BOOL EXTDEVICE</td></tr><tr valign="top"><td>N30</td><td>DEF STRING[80] OUTPUT</td></tr><tr valign="top"><td>N40</td><td>DEF INT PHASE</td></tr><tr valign="top"><td>N50</td><td>EXTOPEN(RESULT,"LOCAL_DRIVE/my_file.txt","SYN","SHARED")</td></tr><tr valign="top"><td>N60</td><td>IF RESULT > 0</td></tr><tr valign="top"><td>N70</td><td>   MSG("Error for EXTOPEN:" &lt;&lt; RESULT)</td></tr><tr valign="top"><td>N80</td><td>ELSE</td></tr><tr valign="top"><td>N90</td><td>   EXTDEVICE=TRUE</td></tr><tr valign="top"><td>N100</td><td>ENDIF</td></tr><tr valign="top"><td colspan="2">…</td></tr><tr valign="top"><td>N200</td><td>PHASE=4</td></tr><tr valign="top"><td>N210</td><td>IF EXTDEVICE</td></tr><tr valign="top"><td>N220</td><td>   OUTPUT=SPRINT("End phase: %D",PHASE)</td></tr><tr valign="top"><td>N230</td><td>   WRITE(RESULT,"LOCAL_DRIVE/my_file.txt",OUTPUT)</td></tr><tr valign="top"><td>N240</td><td>ENDIF</td></tr><tr valign="top"><td colspan="2">…</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p></div>
  </body>
</html>