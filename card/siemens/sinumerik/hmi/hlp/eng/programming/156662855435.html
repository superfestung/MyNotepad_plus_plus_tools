<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Checking for protection zone violation, working area limitation and software limit switches (CALCPOSI)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Checking for protection zone violation, working area limitation and software limit switches (CALCPOSI)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <a name="block_1">
      </a>
      <h3 class="BlocktitleFirst">Function</h3>
      <p>In the workpiece coordinate system (WCS), the CALCPOSI function checks whether, starting from the starting position, the <b>geometry axes</b> can be traversed a specified distance without violating active limits. For the case that the distance cannot be fully traversed because of limits, a positive, decimal-coded status value and the maximum possible traversing distance are returned.</p>
      <a name="block_2">
      </a>
      <h3 class="Blocktitle">Definition</h3>INT CALCPOSI(VAR REAL[3] &lt;Start>, VAR REAL[3] &lt;Dist>, VAR REAL[5] &lt;Limit>, VAR REAL[3] &lt;MaxDist>, BOOL &lt;MeasSys>, INT &lt;TestLim>)<a name="block_3"></a><h3 class="Blocktitle">Syntax</h3>&lt;Status> = CALCPOSI(VAR &lt;Start>, VAR &lt;Dist>, VAR &lt;Limit>, VAR &lt;MaxDist>, &lt;MeasSys>, &lt;TestLim>)<a name="block_4"></a><h3 class="Blocktitle">Meaning</h3><a id="table_dc7626fe-3412-4464-9c5d-7e46e8fb435e"></a> <a id="table_0"></a> <a id="table_dc7626fe-3412-4464-9c5d-7e46e8fb435e"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="20.0%"><col width="10.1%"><col width="14.0%"><col width="55.9%"></colgroup><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>CALCPOSI(...)</code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Predefined function for testing limit violations regarding the geometry axes</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Preprocessing stop:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">No</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Alone in the block:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Yes</p></td></tr><tr valign="top"><td rowspan="13"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;status></code>:</p><p type="p_table_c" align="center">(Part 1)</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Function return value. Negative values indicate error states.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Range of values:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">-8 ≤ x ≤ 100000</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">0</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">The distance can be traversed completely.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-1</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">At least one component is negative in &lt;Limit>.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-2</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Error in a transformation calculation.</p><p type="p_table_l" align="left">Example: The traversing distance passes through a singularity so that the axis positions cannot be defined.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-3</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">The specified traversing distance &lt;Dist> and the maximum possible traversing distance &lt;MaxDist> are linearly dependent. </p><p type="p_table_l" align="left"><b>Note </b><br />Can only occur in conjunction with &lt;TestLim>, bit 4 == 1.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-4</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">The projection of the traversing direction contained in &lt;Dist> on to the limitation surface is the zero vector, or the traversing direction is perpendicular to the violated limitation surface. </p><p type="p_table_l" align="left"><b>Note <br /></b>Can only occur in conjunction with &lt;TestLim>, bit 5 == 1.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-5</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">In &lt;TestLim>, bit 4 == 1 AND bit 5 == 1</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-6</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">At least one machine axis that has to be considered for checking the traversing limits has not been referenced.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-7</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Collision avoidance function: Invalid definition of the kinematic chain or the protection zones.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">-8</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Collision avoidance function: This command cannot be executed because of insufficient memory.</p></td></tr><tr valign="top"><td rowspan="10"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;status></code>:</p><p type="p_table_c" align="center">(Part 2)</p></td><td colspan="3"><p type="p_table_c" style="margin-top: 4px" align="center">Units digit</p><p type="p_table_l" align="left"><b>Note</b><br />If several limits are violated simultaneously, the limit with the greatest restriction on the specified traversing distance is signaled.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">1</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Software limit switches are limiting the traversing distance</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">2</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Working area limitation limits the traversing distance</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">3</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Protection areas are limiting the traversing path</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">4</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Collision avoidance function: Protection areas are limiting the traversing path</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_c" style="margin-top: 4px" align="center">Tens digit</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">1x</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">The initial value violates the limit</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">2x</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">The specified straight line violates the limit. </p><p type="p_table_l" align="left">This value is returned even if the end point does not violate any limit itself, but the path from the starting point to the end point would cause a limit value to be violated (e.g. by passing through a protection zone, curved software limit switches in the WCS for non-linear transformations, e.g. transmit).</p></td></tr><tr valign="top"><td rowspan="6"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;status></code>:</p><p type="p_table_c" align="center">(Part 3)</p></td><td colspan="3"><p type="p_table_c" style="margin-top: 4px" align="center">Hundreds digit</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_c" style="margin-top: 4px" align="center">1xx</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">AND units digit == 1 or 2: <br />The positive limit value has been violated.</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">AND units digit == 3 <sup>1)</sup>:<br />An NC-specific protection area has been violated.</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_c" style="margin-top: 4px" align="center">2xx</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">AND units digit == 1 or 2: <br />The negative limit value has been violated.</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">AND units digit == 3 <sup>1)</sup>: <br />A channel-specific protection zone is violated.</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;status></code>:</p><p type="p_table_c" align="center">(Part 4)</p></td><td colspan="3"><p type="p_table_c" style="margin-top: 4px" align="center">Thousands digit </p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">1xxx</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">AND units digit == 1 or 2: <br />Factor with which the axis number is multiplied that violates the limit. Numbering of the axes begins with 1.</p><p type="p_table_l" align="left">Reference:</p><ul class="table"><li><p>Software limit switches: Machine axes</p></li><li><p>Working area limitation: Geometry axes</p></li></ul><p type="p_table_l" align="left">AND units digit == 3 <sup>1)</sup>: <br />Factor with which the number of the violated protection zone is multiplied.<b> </b></p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;status></code>:</p><p type="p_table_c" align="center">(Part 5)</p></td><td colspan="3"><p type="p_table_c" style="margin-top: 4px" align="center">Hundred thousands digit</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">0xxxxx</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Hundred thousands digit == 0: &lt;Dist> remains unchanged</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">1xxxxx</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">A direction vector is returned in &lt;Dist>, which defines the further motion direction on the limitation surface. </p><p type="p_table_l" align="left">Can only occur with the following supplementary conditions:</p><ul class="table"><li><p>Software limit switch or working area limitation violated (not in the starting point)</p></li><li><p>A transformation is <b>not </b>active</p></li><li><p>&lt;TestID>, bit 4 or bit 5 == 1</p></li></ul></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Start></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Reference to a vector with the start positions:</p><ul class="table"><li><p>&lt;Start> [0]: 1st geometry axis</p></li><li><p>&lt;Start> [1]: 2nd geometry axis</p></li><li><p>&lt;Start> [2]: 3rd geometry axis</p></li></ul></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Parameter type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Input</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">VAR REAL [3]</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Range of values:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">-max. REAL value ≤ x[&lt;n>] ≤ +max. REAL value</p></td></tr><tr valign="top"><td rowspan="9"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Dist></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Reference to a vector.</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Input</b>: Incremental traversing distance</p><ul class="table"><li><p>&lt;Dist> [0]: 1st geometry axis</p></li><li><p>&lt;Dist> [1]: 2nd geometry axis</p></li><li><p>&lt;Dist> [2]: 3rd geometry axis</p></li></ul></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Output </b>(only for set hundred thousands digit in &lt;Status>):</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">&lt;Dist> contains a unit vector <b>v</b> as output value which defines the further traversing direction in the WCS.</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Case 1</b>: Formation of vector <b>v</b> for &lt;TestID>, bit 4 == 1</p><p type="p_table_l" align="left">The input vectors &lt;Dist> and &lt;MaxDist> span the motion plane. This plane is cut by the violated limitation surface. The intersecting line of the two planes defines the direction of vector <b>v</b>.The orientation (sign) is selected so that the angle between the input vector &lt;MaxDist> and <b>v </b>is not greater than 90 degrees.</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Case 2</b>: Formation of vector <b>v</b> for &lt;TestID>, bit 5 == 1</p><p type="p_table_l" align="left">Vector <b>v</b> is the unit vector in the projection direction of the traversing vector contained in &lt;Dist> on the limitation surface. If the projection of the traversing vector on the limitation surface is the zero vector, an error is returned.</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Parameter type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Input/output</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">VAR REAL [3]</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Range of values:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">-max. REAL value ≤ x[&lt;n>] ≤ +max. REAL value</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Limit></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Reference to an array of length 5.</p><ul class="table"><li><p>&lt;Limit> [0 - 2]: Minimum clearance of the geometry axes to the limits:</p><ul><li><p>&lt;Limit> [0]: 1st geometry axis</p></li><li><p>&lt;Limit> [1]: 2nd geometry axis</p></li><li><p>&lt;Limit> [2]: 3rd geometry axis</p></li></ul><p>The minimum clearances are observed with:</p><ul><li><p>Working area limitation: No restrictions</p></li><li><p>Software limit switches: If no transformation is active, or a transformation is active in which a clear assignment of the geometry axes to the linear machine axes is possible, e.g. 5-axis transformations.</p></li></ul></li><li><p>&lt;Limit> [3]: Contains the minimum clearance for linear machine axes which, for example, cannot be assigned a geometry axis because of a non-linear transformation. This value is also used as limit value for the monitoring of the conventional protection zones and the collision avoidance protection zones.</p></li><li><p>&lt;Limit> [4]: Contains the minimum clearance for rotary machine axes which, for example, cannot be assigned a geometry axis because of a non-linear transformation.<br /><b>Note</b><br />This value is only active for the monitoring of the software limit switches for special transformations.</p></li></ul></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Parameter type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Input</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">VAR REAL [5]</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Range of values:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">-max. REAL value ≤ x[n] ≤ +max. REAL value</p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;MaxDist></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Reference to a vector with the incremental traversing distance in which the specified minimum clearance of an axis limit is not violated by any of the relevant machine axes:</p><ul class="table"><li><p>&lt;Dist> [0]: 1st geometry axis</p></li><li><p>&lt;Dist> [1]: 2nd geometry axis</p></li><li><p>&lt;Dist> [2]: 3rd geometry axis</p></li></ul><p type="p_table_l" align="left">If the traversing distance is not restricted, the contents of this return parameter are the same as the contents of &lt;Dist>.</p></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">For &lt;TestID>, bit 4 == 1: &lt;Dist> and &lt;MaxDist></p><p type="p_table_l" align="left">&lt;MaxDist> and &lt;Dist> must contain vectors as input values that span a motion plane. The two vectors must be mutually linearly independent. The absolute value of &lt;MaxDist> is arbitrary. For the calculation of the motion direction, see the description for &lt;Dist>.</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Parameter type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Output</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">VAR REAL [3]</p></td></tr><tr valign="top"><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Range of values:</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">-max. REAL value ≤ x[&lt;n>] ≤ +max. REAL value</p></td></tr><tr valign="top"><td rowspan="5"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;MeasSys></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">System of units (inch/metric) for position and distance specifications (<b>optional</b>)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">BOOL</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">FALSE </p><p type="p_table_c" align="center">(Default) </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">System of units corresponding to the currently active G command from the G group 13 (G70, G71, G700, G710).</p><p type="p_table_l" align="left"><b>Note</b><br />If G70 is active and the basic system is metric (or G71 is active and the basic system is inch), the system variables $AA_IW and $AA_MW are provided in the basic system and, if used, must be converted for CALCPOSI.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">TRUE </p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">System of units according to the set basic system:</p><p type="p_table_l" align="left">MD52806 $MN_ISO_SCALING_SYSTEM</p></td></tr><tr valign="top"><td rowspan="13"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;TestLim></code>:</p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">Bit-coded selection of the limits to be monitored (<b>optional</b>)</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Data type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Default:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Bit 0, 1, 2, 3, 6, 7 = 1 (207)</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center"><b>Value</b></p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Meaning</b></p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">1</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Software limit switch</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">2</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Working area limitation</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">4</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Activated conventional protection zones</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">8</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Preactivated conventional protection zones</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">16</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">With violated software limit switches or working area limitation in &lt;Dist>, return the traversing direction as in <b>Case 1</b> (see above).</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">32</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">With violated software limit switches or working area limitations in &lt;Dist>, return the traversing direction as in <b>Case 2</b> (see above).</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">64</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Activated collision avoidance protection zones</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">128</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Preactivated collision avoidance protection zones</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">256</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Pairs of activated and preactivated collision avoidance protection zones</p></td></tr><tr valign="top"><td colspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><sup>1)</sup> If several protection zones are violated, the protection zone with the greatest restriction on the specified traversing distance is returned.</p></td></tr></table></p><a name="block_5"></a><h3 class="Blocktitle">Example</h3><h4 class="Blocklabel">Limitations</h4><a id="image_792211851_0"></a> <img border="0" src="images/175111413259.png" width="500" height="328"/><p>In the example, the active software limit switches and working area limits in the X-Y plane and the following three protection zones are displayed:</p><ul><li><p>C2: Tool-related, channel-specific protection zone, active, circular, radius = 2 mm</p></li><li><p>C4: Workpiece-related, channel-specific protection zone, preactivated, square, side length = 10 mm</p></li><li><p>N3: Machine-specific protection zone, active, rectangular, side length = 10 mm x 15 mm</p></li></ul><h4 class="Blocklabel">NC program</h4><p>The protection zones and working area limits are defined first in the NC program. The <code>CALCPOSI()</code> function is then called with different parameter assignments.</p><a id="table_9b1c0865-9b37-4767-8b7f-51e3b43e9a4d"></a> <a id="table_1"></a> <a id="table_9b1c0865-9b37-4767-8b7f-51e3b43e9a4d"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_sourcecode" border="1" id="EKGAE"><colgroup><col width="100.0%"></colgroup><tr valign="top"><th><p type="p_table_lb" align="left" class="comment">Program code</p></th></tr><tr valign="top"><td>N10 DEF REAL _START[3]N20 DEF REAL _DIST[3]N30 DEF REAL _LIMIT[5]N40 DEF REAL _MAXDIST[3]N50 DEF INT _PAN60 DEF INT _STATUS</td></tr><tr valign="top"><td>: tool­related protection zone C2N70 CPROTDEF(2, TRUE, 0)N80 G17 G1 X-2 Y0N90 G3 I2 X2N100 I-2 X-2N110 EXECUTE(_PA)</td></tr><tr valign="top"><td>; workpiece-related protection zone C4N120 CPROTDEF(4, FALSE, 0)N130 G17 G1 X0 Y15N140 X10N150 Y25N160 X0N170 Y15N180 EXECUTE(_PA)</td></tr><tr valign="top"><td>; machine-specific protection zone N3N190 NPROTDEF(3, FALSE, 0)N200 G17 G1 X10 Y5N210 X25N220 Y15N230 X10N240 Y5N250 EXECUTE(_PA)</td></tr><tr valign="top"><td>; activate or preactivate protection zonesN260 CPROT(2, 2, 0, 0, 0)N270 CPROT(4, 1, 0, 0, 0)N280 NPROT(3, 2, 0, 0, 0)</td></tr><tr valign="top"><td>; define working area limitsN290 G25 XX=-10 YY=-10N300 G26 XX=20 YY=21</td></tr><tr valign="top"><td>N310 _START[0] = 0.N320 _START[1] = 0.N330 _START[2] = 0.</td></tr><tr valign="top"><td>N340 _DIST[0] = 35.N350 _DIST[1] = 20.N360 _DIST[2] =  0.</td></tr><tr valign="top"><td>N370 _LIMIT[0] = 0.N380 _LIMIT[1] = 0.N390 _LIMIT[2] = 0.N400 _LIMIT[3] = 0.N410 _LIMIT[4] = 0.</td></tr><tr valign="top"><td>N420 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST)N430 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,,3)N440 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,,1)</td></tr><tr valign="top"><td>N450 _START[0] =  5.N460 _START[1] = 17.N470 _START[2] =  0.</td></tr><tr valign="top"><td>N480 _DIST[0] =  0.N490 _DIST[1] =-27.N500 _DIST[2] =  0.</td></tr><tr valign="top"><td>N510 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,,14)N520 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,, 6)</td></tr><tr valign="top"><td>N530 _LIMIT[1] = 2.</td></tr><tr valign="top"><td>N540 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,, 6)</td></tr><tr valign="top"><td>N550 _START[0] = 27.N560 _START[1] = 17.1N570 _START[2] =  0.</td></tr><tr valign="top"><td>N580 _DIST[0] =-27.N590 _DIST[1] =  0.N600 _DIST[2] =  0.</td></tr><tr valign="top"><td>N610 _LIMIT[3] = 2.</td></tr><tr valign="top"><td>N620 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,,12)</td></tr><tr valign="top"><td>N630 _START[0] = 0.N640 _START[1] = 0.N650 _START[2] = 0.</td></tr><tr valign="top"><td>N660 _DIST[0] =  0.N670 _DIST[1] = 30.N680 _DIST[2] =  0.</td></tr><tr valign="top"><td>N690 TRANS X10N700 AROT Z45</td></tr><tr valign="top"><td>N710 _STATUS = CALCPOSI(_START,_DIST, _LIMIT, _MAXDIST)</td></tr><tr valign="top"><td>; delete frames from N690 and N700 againN720 TRANS</td></tr><tr valign="top"><td>N730 _START[0] =  0.N740 _START[1] = 10.N750 _START[2] =  0.</td></tr><tr valign="top"><td>; vectors_DIST and _MAXDIST define the motion planeN760 _DIST[0] = 30.N770 _DIST[1] = 30.N780 _DIST[2] =  0.</td></tr><tr valign="top"><td>N790 _MAXDIST[0] = 1.N800 _MAXDIST[1] = 0.N810 _MAXDIST[2] = 1.</td></tr><tr valign="top"><td>N820 _STATUS = CALCPOSI(_START, _DIST, _LIMIT, _MAXDIST,,17)</td></tr><tr valign="top"><td>N830 M30</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><h4 class="Blocklabel">Results of CALCPOSI()</h4><a id="table_80179661-8e2c-4f85-93b3-fe6441e7c26b"></a> <a id="table_2"></a> <a id="table_80179661-8e2c-4f85-93b3-fe6441e7c26b"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="5.6%"><col width="11.2%"><col width="20.0%"><col width="20.0%"><col width="43.2%"></colgroup><tr valign="top"><th><p type="p_table_cb" align="center" class="comment">N...</p></th><th><p type="p_table_cb" align="center" class="comment">&lt;status></p></th><th><p type="p_table_cb" align="center" class="comment">&lt;MaxDist>[0] ≙ X</p></th><th><p type="p_table_cb" align="center" class="comment">&lt;MaxDist>[1] ≙ Y</p></th><th><p type="p_table_lb" align="left" class="comment">Remarks</p></th></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">420</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">3123</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">8.040</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">4.594</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">N3 is violated.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">430</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">1122</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">20.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">11.429</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">No protection zone monitoring,<br />working area limitation is violated.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">440</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">1121</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">30.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">17.143</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Only software limit monitoring is still active.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">510</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">4213</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0.000</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Starting point violates C4</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">520</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">-27.000</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Preactivated C4 is not monitored. The specified distance can be traversed completely.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">540</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">2222</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">-25.000</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Because _LIMIT[1] = 2, the traversing distance is restricted by the working area limitation.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">620</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">4223</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">-13.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0.000</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Clearance to C4 is a total of 4 mm due to C2 and _LIMIT[3]. Clearance C2 → N3 of 0.1 mm does not result in limitation of the traversing distance.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">710</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">1221</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">0.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">21.213</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">Frame with translation and rotation active. The permissible traversing distance in _DIST applies in the shifted and rotated WCS.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">820</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">102121</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">18.000</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center" class="comment">18.000</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left" class="comment">The software limit switch of the Y axis is violated. The calculation of a further traversing direction is requested with &lt;_TESTLIM> = 17. This direction is in _DIST (0.707, 0.0, 0.707). It is valid because the hundred thousands digit is set in &lt;_STATUS>.</p></td></tr></table></p></div>
    <p>See also:<br />    <a href="156662860939.html">Checking for protection zone violation, working area limitation and software limit switches (CALCPOSI) Additional information</a><br />    <a href="156662840203.html">Defining protection zones (CPROTDEF, NPROTDEF)</a><br />    <a href="156662848139.html">Activating/deactivating protection zones (CPROT, NPROT)</a></p>
  </body>
</html>