<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Parameterizable program return jump RET(...) / RETB(...)</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Parameterizable program return jump RET(...) / RETB(...)</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <p>Generally, a return jump is made from a subprogram into the calling program. Processing is then continued with the program line following the subprogram call.</p>
      <p>In addition, there are also applications where a different return jump behavior is required, for example:</p>
      <ul>
        <li>
          <p>Resume program execution after calling the stock removal cycles in the ISO dialect mode (after describing the contour).</p>
        </li>
        <li>
          <p>Return to the main program from any subprogram level (even after ASUB) for error handling</p>
        </li>
        <li>
          <p>Return jump across several program levels for special applications in compile cycles and in the ISO dialect mode</p>
        </li>
      </ul>
      <p>In cases such as these, predefined procedures RET(...) and RETB(...) are applied, which facilitate return jumps across program levels to the program block defined as destination.    </p>
      <a name="block_1">
      </a>
      <h3 class="Blocktitle">Syntax</h3>RET/RETB("&lt;Target>")RET/RETB("&lt;Target>",&lt;NextBlock>)RET/RETB("&lt;Target>",&lt;NextBlock>,&lt;NrRetJumpLevels>)RET/RETB("&lt;Target>", ,&lt;NrRetJumpLevels>)RET/RETB("&lt;Target>",&lt;NextBlock>,&lt;NrRetJumpLevels>,&lt;RetJumpToProgStart>)RET/RETB( , ,&lt;NrRetJumpLevels>,&lt;RetJumpToProgStart>)<a name="block_2"></a><h3 class="Blocktitle">Meaning</h3><a id="table_6da4c427-c30d-49d8-9dc8-95f947df5767"></a> <a id="table_0"></a> <a id="table_6da4c427-c30d-49d8-9dc8-95f947df5767"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default" border="1"><colgroup><col width="30.0%"><col width="10.0%"><col width="7.5%"><col width="52.5%"></colgroup><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>RET(...)</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">RET(...) first searches the specified return jump target in the program end direction. A search is made toward the program start if the search was not successful. </p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left"><code>RETB(...)</code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left">RETB(...) only searches the specified return jump target in the program start direction.</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;Target></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>1st parameter: Return jump target</b> </p><p type="p_table_l" align="left">Specifies the block where program execution should be resumed.</p><p type="p_table_l" align="left">If parameter &lt;NrRetJumpLevels> is not programmed, then the return jump target is located in the program from which the current subprogram was called.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">STRING</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Value:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">The following can be specified as return jump target:</p><ul class="table"><li><p>Block number</p></li><li><p>Jump marker</p></li><li><p>Character string, for example program or variable name</p><p>The character string must satisfy the following conditions:</p><ul><li><p><b>Blank at the end</b> (contrary to the jump marker, which is identified by a ":" at the end).</p></li><li><p><b>Before the character string</b> only one block number and/or a jump marker may be set, <b>no program commands</b>.</p></li></ul></li></ul></td></tr><tr valign="top"><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>Note:</b><br />The specified jump destination must exist in the program to which the return jump is made. Otherwise, the search does not deliver a result, and alarm 14080 ("Jump destination not found") is output. This is also the case if, for a return jump with RETB, the jump destination is not in the program start direction, but in the program end direction.</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;NextBlock></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>2nd parameter: Following block</b></p><p type="p_table_l" align="left">This parameter should be programmed if program execution should not be continued with the destination block, but only with the following block. </p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td rowspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">Value:</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center">0</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Continue program execution with the block that is specified in parameter &lt;Target> as return jump destination.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">> 0</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Continue program execution with the subsequent block.</p></td></tr><tr valign="top"><td rowspan="7"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;NrRetJumpLevels></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>3rd parameter: Number of program levels to be skipped</b></p><p type="p_table_l" align="left">Specifies the number of program levels to be skipped to access the program level with the destination block</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">INT</p></td></tr><tr valign="top"><td rowspan="4"><p type="p_table_l" style="margin-top: 4px" align="left">Value:</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center">1</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">The program is resumed at the "current program level -1" (just like RET without parameter).</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">2</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">The program is resumed at the "current program level -2", i.e. one level is skipped.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">3</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">The program is resumed at the "current program level -3", i.e. two levels are skipped.</p></td></tr><tr valign="top"><td><p type="p_table_c" style="margin-top: 4px" align="center">...</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">...</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Value range:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">1 ... 15</p></td></tr><tr valign="top"><td rowspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><code>&lt;RetJumpToProgStart></code> </p></td><td colspan="3"><p type="p_table_l" style="margin-top: 4px" align="left"><b>4th parameter: Return jump to the program start</b></p><p type="p_table_l" align="left">This parameter should be programmed, if for a return jump into the main program, and where the <b>ISO dialect mode</b> is active, the program should be continued at the program start.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Type:</p></td><td colspan="2"><p type="p_table_l" style="margin-top: 4px" align="left">BOOL</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Value:</p></td><td><p type="p_table_c" style="margin-top: 4px" align="center">1</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">If the return jump is made into the main program and an <b>ISO dialect mode</b> is active there, then the program branches to the beginning of the program.</p></td></tr></table></p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Note</b></td></tr><tr><td><p class="safety">If a character string, which is not a block number, is specified as return jump destination, when making a search, it is initially assumed that it involves a jump marker. As a consequence, a program or variable name used as return jump destination must not match the name of a jump marker, as otherwise the return jump is always made to the block with the jump marker, and not to the block with the program or variable name (see example 2).</p></td></tr></table><a name="block_3"></a><h3 class="Blocktitle">Constraints</h3><h4 class="Blocklabel">Return jump across several program levels</h4><p>When making a return jump through several program levels, the SAVE instructions of the individual program levels are evaluated.</p><p>If, for a return jump over several program levels, a modal subprogram is active and if in one of the skipped programs the deselection command MCALL is programmed for the modal subprogram, then the modal subprogram remains active.</p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Notice</b></td></tr><tr><td><h4 class="Blocklabel">The return jump can impact modal settings </h4><p class="safety">For a return jump across several program levels, it is the user's responsibility to ensure that processing is continued with the necessary modal settings. This can be achieved, e.g. by programming an appropriate main block.</p></td></tr></table><h4 class="Blocklabel">Process from external source</h4><p>If main programs and subprograms are executed from an external program memory via the "Execution from external source" function, the return destination programmed with RET(...) must be within the reload memory. Otherwise, the jump destination is not found and the program aborts and alarm 14000 ("Illegal end of file") is output.</p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Note</b></td></tr><tr><td><p class="safety">To be able to execute external programs without restrictions with regard to the programmed jump instructions, it is recommended to use the option "Execution from External Storage (EES)" instead of the function "Execution from external source".</p></td></tr></table><a name="block_4"></a><h3 class="Blocktitle">RET(...) examples</h3><h4 class="Blocklabel">Example 1: Resuming in the main program after ASUB execution</h4><a id="table_47567b42-d9c0-47f1-a6d4-9830aea5f753"></a> <a id="table_1"></a> <a id="table_47567b42-d9c0-47f1-a6d4-9830aea5f753"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="ENCAC"><colgroup><col width="42.0%"><col width="58.0%"></colgroup><tr valign="top"><th>Programming</th><th>Comment</th></tr><tr valign="top"><td>N10010 CALL "UP1"</td><td>; Program level 0 (main program)</td></tr><tr valign="top"><td>  N11000 PROC UP1</td><td>; Program level 1</td></tr><tr valign="top"><td colspan="2">  N11010 CALL "UP2"</td></tr><tr valign="top"><td>  N12000 PROC UP2</td><td>; Program level 2</td></tr><tr valign="top"><td>  ...</td><td> </td></tr><tr valign="top"><td>  N19000 PROC ASUP</td><td>; Program level 3 (ASUB execution)</td></tr><tr valign="top"><td>  ...</td><td> </td></tr><tr valign="top"><td>  N19100 RET("N10900", ,$P_STACK)</td><td>; Subprogram return jump into the main program; $P_STACK: actual program level</td></tr><tr valign="top"><td>N10900</td><td>; Target block in the main program</td></tr><tr valign="top"><td>N10910 MCALL</td><td>; Deactivate the modal subprogram call</td></tr><tr valign="top"><td>N10920 G0 G60 G40 M5</td><td>; Initialize additional modal settings</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><h4 class="Blocklabel">Example 2: Character string as return jump destination</h4><p>Main program:</p><a id="table_da1ec62e-1df1-465e-9f9c-1841f3b6c2e6"></a> <a id="table_2"></a> <a id="table_da1ec62e-1df1-465e-9f9c-1841f3b6c2e6"></a> <a id="table_2"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EVEAC"><colgroup><col width="42.0%"><col width="58.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>PROC MAIN_PROGRAM</td><td> </td></tr><tr valign="top"><td>N1000 DEF INT iVar1=1, iVar2=4</td><td> </td></tr><tr valign="top"><td>N1010 ...</td><td> </td></tr><tr valign="top"><td>N1200 subProg1</td><td>; Calls subprogram "subProg1"</td></tr><tr valign="top"><td>N1210 M2 S1000 X10 F1000</td><td> </td></tr><tr valign="top"><td>N1220 ......</td><td> </td></tr><tr valign="top"><td>N1400 subProg2</td><td>; Calls subprogram "subProg2"</td></tr><tr valign="top"><td>N1410 M3 S500 Y20</td><td> </td></tr><tr valign="top"><td>N1420 ..</td><td> </td></tr><tr valign="top"><td>N1500 lab1: iVar1=R10*44</td><td> </td></tr><tr valign="top"><td>N1510 F500 X5</td><td> </td></tr><tr valign="top"><td>N1520 ...</td><td> </td></tr><tr valign="top"><td>N1550 subprog1: G1 X30</td><td>; "subProg1" is defined here as jump marker.</td></tr><tr valign="top"><td>N1560 ...</td><td> </td></tr><tr valign="top"><td>N1600 subProg3</td><td>; Calls subprogram "subProg3"</td></tr><tr valign="top"><td>N1610 ...</td><td> </td></tr><tr valign="top"><td>N1900 M30</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><p>Subprogram subProg1:</p><a id="table_a8e4cadf-9cd4-43a7-ba08-3c68c0e2e221"></a> <a id="table_3"></a> <a id="table_a8e4cadf-9cd4-43a7-ba08-3c68c0e2e221"></a> <a id="table_3"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="E1HAC"><colgroup><col width="42.0%"><col width="58.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>PROC subProg1</td><td> </td></tr><tr valign="top"><td>N2000 R10=R20+100</td><td> </td></tr><tr valign="top"><td>N2010 ...</td><td> </td></tr><tr valign="top"><td>N2200 RET("subProg2")</td><td>; Return jump into the main program at block N1400</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><p>Subprogram subProg2:</p><a id="table_65ca84cf-92ed-45c7-b2eb-23d96e15d36e"></a> <a id="table_4"></a> <a id="table_65ca84cf-92ed-45c7-b2eb-23d96e15d36e"></a> <a id="table_4"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="E5IAC"><colgroup><col width="42.0%"><col width="58.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>PROC subProg2</td><td> </td></tr><tr valign="top"><td>N2000 R10=R20+100</td><td> </td></tr><tr valign="top"><td>N2010 ...</td><td> </td></tr><tr valign="top"><td>N2200 RET("iVar1")</td><td>; Return jump into the main program at block N1500</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><p></p><p>Subprogram subProg3:</p><a id="table_9b0d682b-0484-4191-aa4d-a6e26838e1a3"></a> <a id="table_5"></a> <a id="table_9b0d682b-0484-4191-aa4d-a6e26838e1a3"></a> <a id="table_5"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="ECKAC"><colgroup><col width="42.0%"><col width="58.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>PROC subProg3</td><td> </td></tr><tr valign="top"><td>N2000 R10=R20+100</td><td> </td></tr><tr valign="top"><td>N2010 ...</td><td> </td></tr><tr valign="top"><td>N2200 RET("subProg1")</td><td>; Return jump into the main program at block N1550</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><a name="block_5"></a><h3 class="Blocktitle">RETB(...) example</h3><a id="table_0084281a-0c5c-c4e3-b1e4-b2174b0f3cf9"></a> <a id="table_6"></a> <a id="table_0084281a-0c5c-c4e3-b1e4-b2174b0f3cf9"></a> <a id="table_6"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EHLAC"><colgroup><col width="50.0%"><col width="50.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>EXAMPLE.MPF</td><td> </td></tr><tr valign="top"><td>    …</td><td> </td></tr><tr valign="top"><td>   N3000 START_CYC(parm1, param2, …)</td><td> </td></tr><tr valign="top"><td>   N3010 TECH_CYC1(param1, param2, …)</td><td> </td></tr><tr valign="top"><td>   N3020 TECH_CYC2(param1, param2, …)</td><td> </td></tr><tr valign="top"><td>   N3030 TECH_CYC3(param1, param2, …)</td><td> </td></tr><tr valign="top"><td>   N3040 <b>END_CYC</b>(param1, param2, …)</td><td> </td></tr><tr valign="top"><td>   N3050 …</td><td> </td></tr><tr valign="top"><td>   N4500 START_CYC(param11, param12, …)</td><td> </td></tr><tr valign="top"><td>   N4510 …</td><td> </td></tr><tr valign="top"><td>   N4590 END_CYC(param11, param12, ..)</td><td> </td></tr><tr valign="top"><td>   N5000 …</td><td> </td></tr><tr valign="top"><td>    …</td><td> </td></tr><tr valign="top"><td>N6000 M30</td><td> </td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p><a id="table_f4c81801-b114-c0db-e5b6-0e09b2ef64c6"></a> <a id="table_7"></a> <a id="table_f4c81801-b114-c0db-e5b6-0e09b2ef64c6"></a> <a id="table_7"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_listing" border="1" id="EQNAC"><colgroup><col width="40.0%"><col width="60.0%"></colgroup><tr valign="top"><th>Program code</th><th>Comment</th></tr><tr valign="top"><td>PROC END_CYC(…)</td><td>; Call in the main program, line N3040</td></tr><tr valign="top"><td>   N10000 …</td><td> </td></tr><tr valign="top"><td>   N15000 if status == 1</td><td> </td></tr><tr valign="top"><td>      N15010 RETB("START_CYC")</td><td>; Return jump to the calling program EXAMPLE.MPF; Search for character string "START_CYC"; Search direction: backward in the program start direction ; Program processing is continued with line N3000</td></tr><tr valign="top"><td>   N15020 endif</td><td> </td></tr><tr valign="top"><td>   N15030 if status == 0</td><td> </td></tr><tr valign="top"><td>      N15040 RET</td><td>; Return jump to the calling program EXAMPLE.MPF; Program processing is continued with line N3050</td></tr><tr valign="top"><td>   N15050 endif</td><td> </td></tr><tr valign="top"><td>   N16000 RET("START_CYC")</td><td>; Return jump to the calling program EXAMPLE.MPF; Search for character string "START_CYC"; Search direction: forward in the program end direction; Program processing is continued with line N4500</td></tr><tr valign="top"><td>N17060 RETB</td><td>; Return jump to the calling program EXAMPLE.MPF; Program processing is continued with line N3050; RETB without parameter is identical to RET</td></tr></table><textarea id="textarea" style="display: none;" value="">clipboard</textarea></p></div>
    <p>See also:<br />    <a href="156662689931.html">Parameterizable return jump RET(...) / RETB(...): More information</a><br />    <a href="156662670603.html">Setting a return program jump (overview)</a></p>
  </body>
</html>