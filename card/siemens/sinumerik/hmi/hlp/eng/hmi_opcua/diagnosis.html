<html>
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Diagnosis dialog</title>
  </head>
  <body id="bodyID">
    <div id="nsbanner">
      <div id="TitleRowDefault">
        <h1 class="title">Diagnosis dialog</h1>
      </div>
    </div>
    <div id="nstext" valign="bottom">
      <p>
      </p>
      <ul>
      </ul>
      <a name="block_1">
      </a>
      <h3 class="BlocktitleFirst">Overview</h3>
      <p>Diagnosis screen offers support for troubleshooting and service for OEM with SIEMENS. Diagnosis functionalities are used only for service purpose.</p>
      <p>From the Diagnosis screen user can:</p>
      <ul>
        <li>
          <p>Activate or deactivate the OPC UA Server logging.</p>
        </li>
        <li>
          <p>Configure OPC UA Server logging.</p>
        </li>
        <li>
          <p>Reset the OPC UA Server to factory settings.</p>
        </li>
        <li>
          <p>Export the diagnosis data to an external data storage (for example, USB/Networkshare).</p>
        </li>
        <li>
          <p>Activate or deactivate OPC UA Advanced logging and change parameters.</p>
        </li>
      </ul>
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td>
            <font size="1px">
            </font>
          </td>
        </tr>
      </table>
      <table class="safety" border="1" bgcolor="#eeeeee">
        <colgroup>
          <col width="5%">
          <col width="95%">
        </colgroup>
        <tr>
          <td>
            <b>Note</b>
          </td>
        </tr>
        <tr>
          <td>
            <p class="safety">Diagnosis softkey is visible by default only for manufacturer, service and user access levels.</p>
          </td>
        </tr>
      </table>
      <a name="block_2">
      </a>
      <h3 class="Blocktitle">OPC UA Diagnosis</h3>
      <ol>
        <li>
          <p>Press the "OPC UA" softkey.</p>
        </li>
        <li>
          <p>Press the extended softkey as shown in the below image.</p>
          <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td>
                <font size="1px">
                </font>
              </td>
            </tr>
          </table>
          <table class="safety" border="1" bgcolor="#eeeeee">
            <colgroup>
              <col width="5%">
              <col width="95%">
            </colgroup>
            <tr>
              <td>
                <b>Note</b>
              </td>
            </tr>
            <tr>
              <td>
                <p class="safety">If the extended softkey is disabled then it means the OPC UA Server license is not active.</p>
              </td>
            </tr>
          </table>
        </li>
        <li>
          <p>Press the "Diagnosis" softkey.</p>
          <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td>
                <font size="1px">
                </font>
              </td>
            </tr>
          </table>
          <table class="safety" border="1" bgcolor="#eeeeee">
            <colgroup>
              <col width="5%">
              <col width="95%">
            </colgroup>
            <tr>
              <td>
                <b>Note</b>
              </td>
            </tr>
            <tr>
              <td>
                <p class="safety">The "Diagnosis" softkey will not be visible if OPC UA Server is not actiavted. User need to activate the OPC UA Server from the OPC UA <a href="settingauthentification.html">settings screen</a>.</p>
              </td>
            </tr>
          </table>
          <a id="image_136518884875_0">
          </a> <img border="0" src="images/175242130571.png" width="500" height="239" alt="Softkey Diagnosis "/><p class="imgtitle">Softkey Diagnosis </p></li>
        <li>
          <p>The "OPC UA Diagnosis" dialog will appear. Then press the "Change" softkey. </p>
          <a id="image_136518936075_0">
          </a> <img border="0" src="images/136518944907.png" width="500" height="292" alt="Softkey Change"/><p class="imgtitle">Softkey Change</p></li>
        <li>
          <p>Make the necessary settings for logging.</p>
          <table cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td>
                <font size="1px">
                </font>
              </td>
            </tr>
          </table>
          <table class="safety" border="1" bgcolor="#eeeeee">
            <colgroup>
              <col width="5%">
              <col width="95%">
            </colgroup>
            <tr>
              <td>
                <b>Note</b>
              </td>
            </tr>
            <tr>
              <td>
                <p class="safety">The changes become effective only after the restart of the SINUMERIK Operate.</p>
              </td>
            </tr>
          </table>
          <a id="image_136519017227_0">
          </a> <img border="0" src="images/165778821259.png" width="500" height="289" alt="Activate Logging option"/><p class="imgtitle">Activate Logging option</p><a id="table_baf119a7-fc58-998f-789c-49f3943cdec9"></a> <a id="table_0"></a> <a id="table_baf119a7-fc58-998f-789c-49f3943cdec9"></a> <a id="table_0"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default_list" border="1"><colgroup><col width="30.9%"><col width="69.1%"></colgroup><tr valign="top"><th><p type="p_table_lb" align="left"> Field</p></th><th><p type="p_table_lb" align="left"> Description</p></th></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"OPC UA Server Version"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left"> Shows the OPC UA Server version installed.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"Logging"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Place the checkmark to activate logging and remove the checkmark to deactivate it.</p><p type="p_table_l" align="left">By activating logging, it generates the log of the OPC UA Server.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"Level"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Select the type of level from the drop down list. The drop down list has the following types of level:</p><ul class="table"><li><p>None </p></li><li><p>Error</p></li><li><p>Warning (by dafault)</p></li><li><p>System</p></li><li><p>Info</p></li><li><p>Debug</p></li><li><p>Content</p></li><li><p>All</p></li></ul><p type="p_table_l" align="left">The log will be generated based on the selection of level type.</p><p type="p_table_l" align="left">No log will be generated if you have activated logging and selected "None" from the list.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"No. of log files"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Enter the no. of log files between 3 - 10.</p><p type="p_table_l" align="left">If the user selects 10, and the 10<sup>th</sup> log file is already generated, then it will replace the 1<sup>st</sup> log file.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"No. of records in log file"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Enter the no. of records in log file between 1000 - 99999.</p><p type="p_table_l" align="left">If the user selects 99999, and the 99999<sup>th</sup> record is already generated, then it will replace the 1<sup>st</sup> record.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"Immediate flush"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Place the checkmark to activate the immediate flush and remove the checkmark to deactivate it.</p><p type="p_table_l" align="left">By activating immediate flush, every record will be written immediately into the log file.</p><p type="p_table_l" align="left">This option should be used only for logging without delays.</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"Operating System Time and PLC Time"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">Operating System and PLC date and time are displayed. </p><p type="p_table_l" align="left">The tick <img border="0" src="images/136518953483.png" width="15" height="16"/> icon indicates that the PLC time is in sync with the operating system (HMI Operate) time.</p><p type="p_table_l" align="left"> If the date and time is not in sync,<img border="0" src="images/136519013259.png" width="14" height="18"/> icon is shown and it indicates that time should be updated. </p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">"Max. no. of monitored items with minimum sampling interval"</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">This field provides information about the max. no. of items which can be monitored with minimum sampling interval".</p></td></tr></table></p></li>
        <li>
          <p>Then press "OK".</p>
        </li>
        <li>
          <p>The changes become effective only after the restart of the SINUMERIK Operate.</p>
        </li>
      </ol>
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td>
            <font size="1px">
            </font>
          </td>
        </tr>
      </table>
      <table class="safety" border="1" bgcolor="#eeeeee">
        <colgroup>
          <col width="5%">
          <col width="95%">
        </colgroup>
        <tr>
          <td>
            <b>Note</b>
          </td>
        </tr>
        <tr>
          <td>
            <p class="safety">If the OPC UA server logging is activated for more than 30 days, then it will be automatically disabled on the next HMI restart.</p>
          </td>
        </tr>
      </table>
      <a name="block_3">
      </a>
      <h3 class="Blocktitle">Resetting the OPC UA Server to factory settings</h3>
      <p>This helps the user to reset the OPC UA configuration of the SINUMERIK device to its initial state. This would be helpful when the current OPC UA configuration is not valid and needs to be reset.</p>
      <p>User shall use this as the last option to reconfigure the OPC UA server to its initial state. All settings, IP, Port, and certificates will be deleted and the default values will be restored.</p>
      <p>After the restart of the SINUMERIK Operate, OPC UA server need to be activated again with necessary changes.</p>
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td>
            <font size="1px">
            </font>
          </td>
        </tr>
      </table>
      <table class="safety" border="1" bgcolor="#eeeeee" style="margin-bottom:10px">
        <colgroup>
          <col width="5%">
          <col width="95%">
        </colgroup>
        <tr>
          <td>
            <b>Note</b>
          </td>
        </tr>
        <tr>
          <td>
            <p class="safety">On factory reset, model settings are set to default and model settings cannot be changed with user access level.  </p>
          </td>
        </tr>
      </table>
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td>
            <font size="1px">
            </font>
          </td>
        </tr>
      </table>
      <table class="safety" border="1" bgcolor="#eeeeee">
        <colgroup>
          <col width="5%">
          <col width="95%">
        </colgroup>
        <tr>
          <td>
            <b>Note</b>
          </td>
        </tr>
        <tr>
          <td>
            <h4 class="Blocklabel">
            </h4>
            <p class="safety">Make sure to have an OPC UA archive before starting the process of resetting the OPC UA server to factory settings.</p>
          </td>
        </tr>
      </table>
      <ol>
        <li>
          <p>Press the "OPC UA" softkey.</p>
        </li>
        <li>
          <p>Press the extended softkey.</p>
        </li>
        <li>
          <p>Press the "Diagnosis" softkey. The "OPC UA Diagnosis" dialog will appear.</p>
        </li>
        <li>
          <p>Then press the "Factory settings" softkey.</p>
          <a id="image_136519111179_0">
          </a> <img border="0" src="images/136519146635.png" width="500" height="292" alt="Softkey Factory Settings"/><p class="imgtitle">Softkey Factory Settings</p></li>
        <li>
          <p>The "Factory settings" popup window will appear.</p>
          <a id="image_136519081227_0">
          </a> <img border="0" src="images/136519085835.png" width="379" height="134" alt="Factory settings popup"/><p class="imgtitle">Factory settings popup</p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Note</b></td></tr><tr><td><p class="safety">If the user performs factory settings, the OPC UA Server will be reset to default setting. User need to enable the OPC UA Server again from the OPC UA <a href="settingauthentification.html">settings screen</a>. </p></td></tr></table></li>
        <li>
          <p>Then press "OK". A status message is shown at the bottom, "changes become effective after the restart of OPERATE".</p>
        </li>
      </ol>
      <a name="block_4">
      </a>
      <h3 class="Blocktitle">Exporting diagnosis data</h3>
      <p>This feature exports the OPC UA configuration, log files and other diagnostic information from the SINUMERIK system, onto the selected location on SINUMERIK file system.</p>
      <p>This can be used to analyze details of behavior of the system or root cause of the situation in case of problems.</p>
      <ol>
        <li>
          <p>Press the "OPC UA" softkey.</p>
        </li>
        <li>
          <p>Press the extended softkey.</p>
        </li>
        <li>
          <p>Press the "Diagnosis" softkey. The "OPC UA Diagnosis" dialog will appear.</p>
        </li>
        <li>
          <p>Then press the "Export Diag. data" softkey.</p>
          <a id="image_136519089803_0">
          </a> <img border="0" src="images/136519098635.png" width="500" height="292" alt="Softkey Export Diag data"/><p class="imgtitle">Softkey Export Diag data</p></li>
        <li>
          <p>The "Export OPC UA Diagnosis Data" popup window will appear.</p>
          <a id="image_136519102603_0">
          </a> <img border="0" src="images/162715849099.png" width="472" height="190" alt="Export OPC UA Diagnosis data popup"/><p class="imgtitle">Export OPC UA Diagnosis data popup</p></li>
        <li>
          <p>Select location on SINUMERIK file system.</p>
        </li>
        <li>
          <p>Then press "OK".</p>
        </li>
        <li>
          <p>The diagnosis data will be saved to the folder (as selected location on SINUMERIK file system) in the format "OpcUaDiagnosisData_Year_Month_Day-Hour_Minute_Second",(for example: "OpcUaDiagnosisData_2020_06_22-11_12_56").</p>
        </li>
      </ol>
      <a name="block_5">
      </a>
      <h3 class="Blocktitle">Settings for OPC UA Advanced logging</h3>
      <p>If you have activated the additional license for OPC UA Advanced, you can set the parameters for OPC UA Advanced logging.</p>
      <ol>
        <li>
          <p>Press the "OPC UA" softkey.</p>
        </li>
        <li>
          <p>Press the extended softkey.</p>
        </li>
        <li>
          <p>Press the "Diagnosis" softkey. The "OPC UA Diagnosis" dialog will appear.</p>
        </li>
        <li>
          <p>Then press the "ADV log" softkey.</p>
          <a id="image_153267317643_0">
          </a> <img border="0" src="images/153267894283.png" width="500" height="275" alt="Softkey ADV log"/><p class="imgtitle">Softkey ADV log</p></li>
        <li>
          <p>The "OPC UA Adv log" dialog will appear. You can read the settings for OPC UA Advanced logging.</p>
          <a id="image_153267884939_0">
          </a> <img border="0" src="images/153267889547.png" width="500" height="275" alt="ADV log dialog"/><p class="imgtitle">ADV log dialog</p></li>
        <li>
          <p>Press the "Change" softkey"</p>
        </li>
        <li>
          <p>Activate the OPC UA Advanced logging with the corresponding checkbox.</p>
        </li>
        <li>
          <p>Set the parameters for OPC UA Advanced log file.</p>
          <a id="table_62f949f5-a261-067c-2ee0-0f429758820e">
          </a> <a id="table_1"></a> <a id="table_62f949f5-a261-067c-2ee0-0f429758820e"></a> <a id="table_1"></a> <p><table width="100%" cellspacing="0" cellpadding="0" class="table_default_list" border="1"><colgroup><col width="50.0%"><col width="25.0%"><col width="25.0%"></colgroup><tr valign="top"><th rowspan="2"><p type="p_table_lb" align="left">Parameters</p></th><th colspan="2"><p type="p_table_cb" align="center">Value</p></th></tr><tr valign="top"><th><p type="p_table_lb" align="left">Min</p></th><th><p type="p_table_lb" align="left">Max</p></th></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Number of log files</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">3</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">10</p></td></tr><tr valign="top"><td><p type="p_table_l" style="margin-top: 4px" align="left">Number of record in the log file</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">10,000</p></td><td><p type="p_table_l" style="margin-top: 4px" align="left">99,999</p></td></tr></table></p><table cellpadding="0" cellspacing="0" border="0"><tr><td><font size="1px"></font></td></tr></table><table class="safety" border="1" bgcolor="#eeeeee"><colgroup><col width="5%"><col width="95%"></colgroup><tr><td><b>Note</b></td></tr><tr><td><h4 class="Blocklabel">Maximum values reached</h4><p class="safety">If the maximum number of log files is reached and each file contains the maximum number of records, the oldest log file will automatically be deleted and a new log file will be created.</p></td></tr></table><p></p></li>
        <li>
          <p>Press "OK". The settings for OPC UA Advanced logging are saved.</p>
        </li>
      </ol>
      <p>You can find further information on the OPC UA Advanced logging functionality in chapter OPC UA Advanced logging.</p>
    </div>
  </body>
</html>